<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0 plus SVG 1.1//EN" "http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>Intersection Theory Section 4.2 -- The Chow ring of GG(1,3)</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <link type="text/css" rel="stylesheet" href="../../../../Macaulay2/Style/doc.css"/>

    <link rel="stylesheet" href="../../../../Macaulay2/Style/katex/katex.min.css" />
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/katex.min.js"></script>
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/auto-render.min.js"></script>
    <script defer="defer" type="text/javascript">
      var macros = {
          "\\break": "\\\\",
          "\\ZZ": "\\mathbb{Z}",
          "\\NN": "\\mathbb{N}",
          "\\QQ": "\\mathbb{Q}",
          "\\RR": "\\mathbb{R}",
          "\\CC": "\\mathbb{C}",
          "\\PP": "\\mathbb{P}"
      }, delimiters = [
          { left: "$$",  right: "$$",  display: true},
          { left: "\\[", right: "\\]", display: true},
          { left: "$",   right: "$",   display: false},
          { left: "\\(", right: "\\)", display: false}
      ], ignoredTags = ["tt", "script", "noscript", "style", "textarea", "pre", "code", "option"];
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, { delimiters: delimiters, macros: macros, ignoredTags: ignoredTags, trust: true });
      });
    </script>
    <style type="text/css">.katex { font-size: 1em; }</style>
    <link href="../../../../Macaulay2/Style/katex/contrib/copy-tex.min.css" rel="stylesheet" type="text/css" />
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/copy-tex.min.js"></script>
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/render-a11y-string.min.js"></script>
    <script type="text/javascript" src="../../../../Macaulay2/Style/highlight.js"></script>
  </head>
  <body>
    <table class="buttons">
      <tr>
<td>          <div>
<a href="___Intersection_sp__Theory_sp__Section_sp4.3.html">next</a> | <a href="___Intersection_sp__Theory_sp__Section_sp4.1.html">previous</a> | <a href="___Intersection_sp__Theory_sp__Section_sp4.3.html">forward</a> | <a href="___Intersection_sp__Theory_sp__Section_sp4.1.html">backward</a> | <a href="index.html">up</a> | <a href="index.html">top</a> | <a href="master.html">index</a> | <a href="toc.html">toc</a> | <a href="http://macaulay2.com/">Macaulay2 website</a>          </div>
</td>      </tr>
    </table>
    <div>
<a title="Examples using M2 and Schubert2 to do intersection theory" href="index.html">Book3264Examples</a> > <a title="The Chow ring of GG(1,3)" href="___Intersection_sp__Theory_sp__Section_sp4.2.html">Intersection Theory Section 4.2</a>    </div>
    <hr/>
    <div>
      <h1>Intersection Theory Section 4.2 -- The Chow ring of GG(1,3)</h1>
      <div>
        <div>
          <p>Subsection 4.2.2</p>
          <p>Schubert2 identifies ${\mathbb G}(1,3)$ with its Chow ring.  We can see this directly using the command <tt>intersectionRing</tt>.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i1 : G = flagBundle({2,2})

o1 = G

o1 : a flag bundle with subquotient ranks {2:2}</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i2 : intersectionRing G

                                   QQ[][H   ..H   ]
                                         1,1   2,2
o2 = ---------------------------------------------------------------------------
     (- H    - H   , - H    - H   H    - H   , - H   H    - H   H   , -H   H   )
         1,1    2,1     1,2    1,1 2,1    2,2     1,2 2,1    1,1 2,2    1,2 2,2

o2 : QuotientRing</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>The generators $H_{i,j}$ of the above ring are defined by the formula $H_{i,j} = c_j(B_i)$ where $B_i$ is the <tt>i</tt>-th bundle in the list G.Bundles (numbered starting with 1) and $c_j$ is the <tt>j</tt>-th Chern class, defined in Ch. 5.  The relationship with the Schubert classes on ${\mathbb G}(1,3)$ is as follows:</p>
          <p>$H_{2,1} = \sigma_1$ <br/> $H_{2,2} = \sigma_2$ <br/> $H_{1,1} = -\sigma_1$ <br/> $H_{1,2} = \sigma_{1,1}$</p>
          <p>The Schubert classes can also be accessed directly using the <tt>placeholderSchubertCycle</tt> command -- see Section 4.3 for details.</p>
          <p>As an example, we can compute $(\sigma_1)^2$:</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i3 : sigma_1 = H_(2,1)

o3 = H
      2,1

                                   QQ[][H   ..H   ]
                                         1,1   2,2
o3 : ---------------------------------------------------------------------------
     (- H    - H   , - H    - H   H    - H   , - H   H    - H   H   , -H   H   )
         1,1    2,1     1,2    1,1 2,1    2,2     1,2 2,1    1,1 2,2    1,2 2,2</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i4 : c = (sigma_1)^2

      2
o4 = H
      2,1

                                   QQ[][H   ..H   ]
                                         1,1   2,2
o4 : ---------------------------------------------------------------------------
     (- H    - H   , - H    - H   H    - H   , - H   H    - H   H   , -H   H   )
         1,1    2,1     1,2    1,1 2,1    2,2     1,2 2,1    1,1 2,2    1,2 2,2</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>Oops!  This just gave us $H_{2,1}^2$ back!  Schubert2 actually uses $\sigma_1^2$ and $\sigma_{1,1}$ as its &quot;preferred basis&quot; for the codimension-2 part of the Chow ring of ${\mathbb G}(1,3)$.  To convert to the Schubert basis, we use the function <a title="Express cycles on G(k,n) in terms of the Schubert basis" href="_placeholder__To__Schubert__Basis.html">placeholderToSchubertBasis</a>:</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i5 : placeholderToSchubertBasis(c,G)

o5 = s       + s
      {1, 1}    {2, 0}

o5 : QQ[][s      , s      , s      , s      , s      , s      ]
           {0, 0}   {1, 0}   {1, 1}   {2, 0}   {2, 1}   {2, 2}</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>We recover the formula of Theorem 4.13: $\sigma_1^2 = \sigma_2 + \sigma_{1,1}$.</p>
          <p>Subsection 4.2.4</p>
          <p>How many lines in ${\mathbb P}^3$ meet four general lines?</p>
          <p>After phrasing the problem in terms of Schubert calculus, this is easy to calculate both by hand and in Schubert2:</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i6 : sigma_1 = H_(2,1)

o6 = H
      2,1

                                   QQ[][H   ..H   ]
                                         1,1   2,2
o6 : ---------------------------------------------------------------------------
     (- H    - H   , - H    - H   H    - H   , - H   H    - H   H   , -H   H   )
         1,1    2,1     1,2    1,1 2,1    2,2     1,2 2,1    1,1 2,2    1,2 2,2</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i7 : integral (sigma_1)^4

o7 = 2</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>The command <tt>integral</tt> here returns the degree of the zero-cycle $(\sigma_1)^4$, which is the number we want (namely, 2).</p>
          <p>Lines meeting a curve</p>
          <p>We can easily build a function which, given the degree $d$ of a space curve $C$, returns the cycle of lines in ${\mathbb P}^3$ meeting $C$:</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i8 : sigma_1 = H_(2,1)

o8 = H
      2,1

                                   QQ[][H   ..H   ]
                                         1,1   2,2
o8 : ---------------------------------------------------------------------------
     (- H    - H   , - H    - H   H    - H   , - H   H    - H   H   , -H   H   )
         1,1    2,1     1,2    1,1 2,1    2,2     1,2 2,1    1,1 2,2    1,2 2,2</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i9 : linesMeetingCurve = d -> d*sigma_1

o9 = linesMeetingCurve

o9 : FunctionClosure</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>And now we can calculate, for example, how many lines meet four general conics:</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i10 : integral (linesMeetingCurve(2))^4

o10 = 32</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>But we really want to answer the question once and for all: how many lines meet four general curves of degree $d$?  To do this, we use the <a title="make an abstract variety from nothing, equipped with some parameters and some bundles" href="../../Schubert2/html/_base.html">base</a> command, which allows us auxiliary parameters:</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i11 : S = base d --Our base variety, with one &quot;auxiliary parameter&quot; d

o11 = S

o11 : an abstract variety of dimension 0</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i12 : G' = flagBundle({2,2},S,VariableNames => K) --GG(1,3) with our extra parameter

o12 = G'

o12 : a flag bundle with subquotient ranks {2:2}</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i13 : intersectionRing G' --note the additional parameter d

                                   QQ[d][K   ..K   ]
                                          1,1   2,2
o13 = ---------------------------------------------------------------------------
      (- K    - K   , - K    - K   K    - K   , - K   K    - K   K   , -K   K   )
          1,1    2,1     1,2    1,1 2,1    2,2     1,2 2,1    1,1 2,2    1,2 2,2

o13 : QuotientRing</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i14 : sigma_1 = K_(2,1)

o14 = K
       2,1

                                   QQ[d][K   ..K   ]
                                          1,1   2,2
o14 : ---------------------------------------------------------------------------
      (- K    - K   , - K    - K   K    - K   , - K   K    - K   K   , -K   K   )
          1,1    2,1     1,2    1,1 2,1    2,2     1,2 2,1    1,1 2,2    1,2 2,2</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i15 : linesmeetingcurve = d*sigma_1

o15 = d*K
         2,1

                                   QQ[d][K   ..K   ]
                                          1,1   2,2
o15 : ---------------------------------------------------------------------------
      (- K    - K   , - K    - K   K    - K   , - K   K    - K   K   , -K   K   )
          1,1    2,1     1,2    1,1 2,1    2,2     1,2 2,1    1,1 2,2    1,2 2,2</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i16 : integral linesmeetingcurve^4

        4
o16 = 2d

o16 : QQ[d]</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>And we get back the answer $2d^4$, solving the problem once and for all.</p>
          <p>Chords to a Space Curve</p>
          <p>For each $d$ and $g$ we build the cycle in ${\mathbb G}(1,3)$ of lines secant to a general curve of degree d and genus g:</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i17 : S = base(g,d') --We use d' to avoid the d from the last example

o17 = S

o17 : an abstract variety of dimension 0</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i18 : G'' = flagBundle({2,2},S,VariableNames => L)

o18 = G''

o18 : a flag bundle with subquotient ranks {2:2}</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i19 : sigma_2 = L_(2,2)

o19 = L
       2,2

                                 QQ[g, d'][L   ..L   ]
                                            1,1   2,2
o19 : ---------------------------------------------------------------------------
      (- L    - L   , - L    - L   L    - L   , - L   L    - L   L   , -L   L   )
          1,1    2,1     1,2    1,1 2,1    2,2     1,2 2,1    1,1 2,2    1,2 2,2</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i20 : sigma_(1,1) = L_(1,2)

       2
o20 = L    - L
       2,1    2,2

                                 QQ[g, d'][L   ..L   ]
                                            1,1   2,2
o20 : ---------------------------------------------------------------------------
      (- L    - L   , - L    - L   L    - L   , - L   L    - L   L   , -L   L   )
          1,1    2,1     1,2    1,1 2,1    2,2     1,2 2,1    1,1 2,2    1,2 2,2</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i21 : cycleofchords = ((d'-1)*(d'-2)/2 - g)*sigma_2 + (d'*(d'-1)/2)*sigma_(1,1)

       1  2   1    2
o21 = (-d'  - -d')L    + (- g - d' + 1)L
       2      2    2,1                  2,2

                                 QQ[g, d'][L   ..L   ]
                                            1,1   2,2
o21 : ---------------------------------------------------------------------------
      (- L    - L   , - L    - L   L    - L   , - L   L    - L   L   , -L   L   )
          1,1    2,1     1,2    1,1 2,1    2,2     1,2 2,1    1,1 2,2    1,2 2,2</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>The keynote question was: how many lines are secant to two general twisted cubics?  But we can do better, and answer the question: how many lines are secant to two general curves of degree $d$ and genus $d$?</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i22 : chordstotwocurves = integral cycleofchords^2

      1  4       2      3    2           7  2
o22 = -d'  - g*d'  - 2d'  + g  + 3g*d' + -d'  - 2g - 3d' + 1
      2                                  2

o22 : QQ[g, d']</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>Now if we want to answer our specific question, we just substitute in the desired values for $d$ and $g$:</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i23 : sub(chordstotwocurves, {d' => 3, g => 0/1})

o23 = 10

o23 : QQ</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>WARNING: because of some ugly M2 design decisions, if you don't make at least one of $d'$ or $g$ a rational number, this substitute will return the wrong answer!  Hopefully this design will be changed in the future.</p>
          <p>Exercise 4.25 (a):</p>
          <p>If $C$ is a smooth, nondegenerate space curve and $L$ and $M$ are general lines in ${\mathbb P}^3$, how many chords to $C$ meet both $L$ and $M$?  Using our work above, we immediately compute:</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i24 : sigma_1 = L_(2,1)

o24 = L
       2,1

                                 QQ[g, d'][L   ..L   ]
                                            1,1   2,2
o24 : ---------------------------------------------------------------------------
      (- L    - L   , - L    - L   L    - L   , - L   L    - L   L   , -L   L   )
          1,1    2,1     1,2    1,1 2,1    2,2     1,2 2,1    1,1 2,2    1,2 2,2</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i25 : integral (cycleofchords*(sigma_1)^2)

        2
o25 = d'  - g - 2d' + 1

o25 : QQ[g, d']</code></pre>
</td>          </tr>
        </table>
        <div>
          <p></p>
          <p>Tangent Lines to a Surface</p>
          <p>Exercise 4.28:</p>
          <p>Using our Grassmannian <tt>G'</tt> with an extra base parameter $d$, we build the cycle of tangent lines to a general surface of degree $d$:</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i26 : sigma_1 = K_(2,1)

o26 = K
       2,1

                                   QQ[d][K   ..K   ]
                                          1,1   2,2
o26 : ---------------------------------------------------------------------------
      (- K    - K   , - K    - K   K    - K   , - K   K    - K   K   , -K   K   )
          1,1    2,1     1,2    1,1 2,1    2,2     1,2 2,1    1,1 2,2    1,2 2,2</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i27 : tangentcycle = d*(d-1)*sigma_1

        2
o27 = (d  - d)K
               2,1

                                   QQ[d][K   ..K   ]
                                          1,1   2,2
o27 : ---------------------------------------------------------------------------
      (- K    - K   , - K    - K   K    - K   , - K   K    - K   K   , -K   K   )
          1,1    2,1     1,2    1,1 2,1    2,2     1,2 2,1    1,1 2,2    1,2 2,2</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>Now we can compute the number of lines tangent to four general surfaces of degree $d$:</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i28 : tangentlines = integral tangentcycle^4

        8     7      6     5     4
o28 = 2d  - 8d  + 12d  - 8d  + 2d

o28 : QQ[d]</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>In particular, we calculate the number of lines tangent to four general quadric surfaces:</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i29 : sub(tangentlines, d => 2/1)

o29 = 32

o29 : QQ</code></pre>
</td>          </tr>
        </table>
      </div>
    </div>
  </body>

</html>
