<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0 plus SVG 1.1//EN" "http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>rationalPoints -- Find the rational points on a variety</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <link type="text/css" rel="stylesheet" href="../../../../Macaulay2/Style/doc.css"/>

    <link rel="stylesheet" href="../../../../Macaulay2/Style/katex/katex.min.css" />
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/katex.min.js"></script>
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/auto-render.min.js"></script>
    <script defer="defer" type="text/javascript">
      var macros = {
          "\\break": "\\\\",
          "\\ZZ": "\\mathbb{Z}",
          "\\NN": "\\mathbb{N}",
          "\\QQ": "\\mathbb{Q}",
          "\\RR": "\\mathbb{R}",
          "\\CC": "\\mathbb{C}",
          "\\PP": "\\mathbb{P}"
      }, delimiters = [
          { left: "$$",  right: "$$",  display: true},
          { left: "\\[", right: "\\]", display: true},
          { left: "$",   right: "$",   display: false},
          { left: "\\(", right: "\\)", display: false}
      ], ignoredTags = ["tt", "script", "noscript", "style", "textarea", "pre", "code", "option"];
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, { delimiters: delimiters, macros: macros, ignoredTags: ignoredTags, trust: true });
      });
    </script>
    <style type="text/css">.katex { font-size: 1em; }</style>
    <link href="../../../../Macaulay2/Style/katex/contrib/copy-tex.min.css" rel="stylesheet" type="text/css" />
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/copy-tex.min.js"></script>
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/render-a11y-string.min.js"></script>
    <script type="text/javascript" src="../../../../Macaulay2/Style/highlight.js"></script>
  </head>
  <body>
    <table class="buttons">
      <tr>
<td>          <div>
<a href="_base__Change.html">next</a> | previous | <a href="_zeros.html">forward</a> | <a href="index.html">backward</a> | <a href="index.html">up</a> | <a href="index.html">top</a> | <a href="master.html">index</a> | <a href="toc.html">toc</a> | <a href="http://macaulay2.com/">Macaulay2 website</a>          </div>
</td>      </tr>
    </table>
    <div>
<a title="Find the rational points on a variety" href="index.html">RationalPoints2</a> > <a title="Find the rational points on a variety" href="_rational__Points.html">rationalPoints</a>    </div>
    <hr/>
    <div>
      <h1>rationalPoints -- Find the rational points on a variety</h1>
      <div>
        <h2>Synopsis</h2>
        <ul>
          <li>
            <dl class="element">
              <dt>Usage: </dt>
              <dd><code class="language-macaulay2">rationalPoints I</code></dd>
              <dd><code class="language-macaulay2">rationalPoints(F, I)</code></dd>
            </dl>
          </li>
          <li>
Inputs:            <ul>
              <li>
<span><tt>I</tt>, <span>an <a title="the class of all ideals" href="../../Macaulay2Doc/html/___Ideal.html">ideal</a></span>, viewed as an affine variety; <span>an <a title="the class of all affine varieties" href="../../Macaulay2Doc/html/___Affine__Variety.html">affine variety</a></span> / <span>a <a title="the class of all projective varieties" href="../../Macaulay2Doc/html/___Projective__Variety.html">projective variety</a></span> can also be used</span>              </li>
              <li>
<span><tt>F</tt>, the coefficient field; if not specified then it is taken to be the field of definition of <tt>I</tt></span>              </li>
            </ul>
          </li>
          <li>
<a href="../../Macaulay2Doc/html/_using_spfunctions_spwith_spoptional_spinputs.html">Optional inputs</a>:            <ul>
              <li>
<span><tt>Amount</tt><tt> => </tt><span>a <a title="the class of Boolean values" href="../../Macaulay2Doc/html/___Boolean.html">Boolean value</a></span>, <span>default value false</span>, whether to only compute the number of rational points.</span>              </li>
              <li>
<span><tt>Projective</tt><tt> => </tt><span>a <a title="the class of Boolean values" href="../../Macaulay2Doc/html/___Boolean.html">Boolean value</a></span>, <span>default value false</span>, whether to treat the ideal as a homogeneous ideal and consider the corresponding projective variety</span>              </li>
              <li>
<span><tt>Split</tt><tt> => </tt><span>a <a title="the class of Boolean values" href="../../Macaulay2Doc/html/___Boolean.html">Boolean value</a></span>, <span>default value false</span>, whether to compute all rational points over the splitting field, works only if <tt>I</tt> is 0-dimensional (ignored if <tt>F</tt> is specified)</span>              </li>
              <li>
<span><tt>Verbose</tt><tt> => </tt><span>a <a title="the class of Boolean values" href="../../Macaulay2Doc/html/___Boolean.html">Boolean value</a></span>, <span>default value false</span>, whether to print the polynomials computed that do not split in the coefficient field (if <tt>Split</tt> is set to <tt>true</tt>, it will instead print information when a field extension is performed)</span>              </li>
              <li>
<span><tt>Bound</tt><tt> => </tt><span>a <a title="the class of all numbers" href="../../Macaulay2Doc/html/___Number.html">number</a></span>, <span>default value null</span>, over a number field, specify the upper bound of the multiplicative height for the points to enumerate</span>              </li>
              <li>
<span><tt>KeepAll</tt><tt> => </tt><span>a <a title="the class of Boolean values" href="../../Macaulay2Doc/html/___Boolean.html">Boolean value</a></span>, <span>default value false</span>, whether to keep the rational points found with height exceeding the bound</span>              </li>
            </ul>
          </li>
          <li>
Outputs:            <ul>
              <li>
<span>Either <span>a <a title="the class of all lists -- {...}" href="../../Macaulay2Doc/html/___List.html">list</a></span> of points, or the number of such points if <tt>Amount</tt> is set to true. In the affine case each point is represented by <span>a <a title="the class of all lists -- {...}" href="../../Macaulay2Doc/html/___List.html">list</a></span> of coordinates, and in the projective case each point is <span>an instance of the type <a title="Class of a projective point" href="___Projective__Point.html">ProjectivePoint</a></span>.</span>              </li>
            </ul>
          </li>
        </ul>
      </div>
      <div>
        <h2>Description</h2>
        <div>
          <p>This method takes in an ideal <tt>I</tt> and returns a list of rational points on the variety defined by the ideal. The algorithm uses brute force plus some elimination. Options are available for different use cases.</p>
        </div>
        <div>
          <h3>Over finite fields</h3>
        </div>
        <div>
          <p>Over a finite field (<tt>ZZ/p</tt> or <tt>GF q</tt>), the ideal can have arbitrary dimension. By default it will be regarded as an affine variety.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i1 : R = ZZ/5[x,y,z]; I = ideal(x^3-y*z, x+y);

o2 : Ideal of R</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i3 : rationalPoints I

o3 = {{0, 0, 0}, {0, 0, 1}, {-2, 2, 1}, {2, -2, 1}, {0, 0, 2}, {0, 0, -2},
     ------------------------------------------------------------------------
     {0, 0, -1}, {-1, 1, -1}, {1, -1, -1}}

o3 : List</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i4 : #rationalPoints Spec(R/I)

o4 = 9</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i5 : #rationalPoints_(GF 25) I

o5 = 49</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>To consider projective varieties, one can use the option <tt>Projective=>true</tt> or pass directly <span>a <a title="the class of all projective varieties" href="../../Macaulay2Doc/html/___Projective__Variety.html">projective variety</a></span>. In this case, the rational points are given in homogeneous coordinates. The first non-zero coordinate will be normalized to 1.</p>
        </div>
        <div>
          <p>For example we can take the twisted cubic, which is a smooth rational curve so it has q+1 points over a finite field of q elements.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i6 : ZZ/5[x,y,z,w]; I = ideal &quot;xz-y2,xw-yz,yw-z2&quot;;

              ZZ
o7 : Ideal of --[x..z, w]
               5</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i8 : rationalPoints(I, Projective => true)

o8 = {(1 : 0 : 0 : 0), (1 : 1 : 1 : 1), (1 : -2 : -1 : 2), (1 : 2 : -1 : -2),
     ------------------------------------------------------------------------
     (1 : -1 : 1 : -1), (0 : 0 : 0 : 1)}

o8 : List</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i9 : #rationalPoints variety I

o9 = 6</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i10 : #rationalPoints_(GF 25) variety I

o10 = 26</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>If only the number of rational points is needed, set <tt>Amount</tt> to <tt>true</tt> can sometimes speed up the computation.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i11 : ZZ/101[u_0..u_10]; f = sum toList(u_0..u_10); I = ideal f

o13 = ideal(u  + u  + u  + u  + u  + u  + u  + u  + u  + u  + u  )
             0    1    2    3    4    5    6    7    8    9    10

                ZZ
o13 : Ideal of ---[u ..u  ]
               101  0   10</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i14 : time rationalPoints(I, Amount => true)
     -- used 0.00443017 seconds

o14 = 110462212541120451001</code></pre>
</td>          </tr>
        </table>
        <div>
          <h3>Over number fields</h3>
        </div>
        <div>
          <p>Over a number field one can use the option <tt>Bound</tt> to specify a maximal multiplicative height given by $(x_0:\dots:x_n)\mapsto \prod_{v}\max_i|x_i|_v ^{d_v/d}$ (this is also available as a method <a title="Multiplicative height function" href="_global__Height.html">globalHeight</a>).</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i15 : QQ[x,y,z]; I = homogenize(ideal(y^2-x*(x-1)*(x-2)*(x-5)*(x-6)), z);

o16 : Ideal of QQ[x..z]</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i17 : rationalPoints(variety I, Bound=>12)

                             1            1             1            1       
o17 = {(1 : 0 : 1), (1 : 0 : -), (1 : 2 : -), (1 : -2 : -), (1 : 0 : -), (1 :
                             2            3             3            5       
      -----------------------------------------------------------------------
          1
      0 : -), (0 : 1 : 0), (0 : 0 : 1)}
          6

o17 : List</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i18 : globalHeight \ oo

o18 = {1, 2, 6, 6, 5, 6, 1, 1}

o18 : List</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>During the enumeration, sometimes there are rational points found with height exceeding the bound. These are cast away by default. Use <tt>KeepAll=>true</tt> to keep such points (this will also avoid the heavy task of computing the height function, especially over number fields other than <tt>QQ</tt>).</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i19 : rationalPoints(variety I, Bound=>12, KeepAll=>true)

                             1            1             1            1       
o19 = {(1 : 0 : 1), (1 : 0 : -), (1 : 2 : -), (1 : -2 : -), (1 : 0 : -), (1 :
                             2            3             3            5       
      -----------------------------------------------------------------------
          1              1               1
      0 : -), (1 : 12 : --), (1 : -12 : --), (0 : 1 : 0), (0 : 0 : 1)}
          6             10              10

o19 : List</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i20 : globalHeight \ oo

o20 = {1, 2, 6, 6, 5, 6, 120, 120, 1, 1}

o20 : List</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>In the affine case, the height function is used on individual coordinates, so for example <tt>{2,1/2}</tt> will be considered as of height 2 instead of 4.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i21 : QQ[x,y]; rationalPoints(ideal(x-2), Bound=>2)

                                                       1       1
o22 = {{2, -2}, {2, -1}, {2, 0}, {2, 1}, {2, 2}, {2, - -}, {2, -}}
                                                       2       2

o22 : List</code></pre>
</td>          </tr>
        </table>
        <div>
          <h3>Zero-dimensional ideals</h3>
        </div>
        <div>
          <p>For a 0-dimensional ideal, all the rational points can be found, including those in the splitting field. Set the option <tt>Verbose</tt> to <tt>true</tt> will print the polynomials found not splitting in the coefficient field, and set <tt>Split</tt> to <tt>true</tt> will automatically make field extensions and compute all the points over the splitting field. The information on the splitting field can either be printed using <tt>Verbose=>true</tt>, or be retrieved from any coordinate of the points. One can refer to <a title="Define field extensions" href="_ext__Field.html">extField</a> and <a title="Perform base change for field extensions" href="_base__Change.html">baseChange</a> for the methods used in handling field extensions.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i23 : R = QQ[x,y]; I = ideal(x^2+y^2-1,x^3+y^3-1);

o24 : Ideal of R</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i25 : rationalPoints(I, Verbose => true)
-- the following polynomials do not split
   -- 2*x^2+4*x+3

o25 = {{1, 0}, {0, 1}}

o25 : List</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i26 : rationalPoints(I, Verbose => true, Split => true)
-- base change to the field QQ[a]/(a^2+4*a+6)

                          1       1     1     1
o26 = {{1, 0}, {0, 1}, {- -a - 2, -a}, {-a, - -a - 2}}
                          2       2     2     2

o26 : List</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i27 : ring \ first oo

          QQ[a]          QQ[a]
o27 = {-----------[], -----------[]}
        2              2
       a  + 4a + 6    a  + 4a + 6

o27 : List</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>Note that the computations over number fields of large degree are slow. In such cases it might be better to switch to a large finite field where the program runs much faster. One could also use numerical algorithms implemented in the packages <a title="polynomial system solver via eigen-computations" href="../../EigenSolver/html/index.html">EigenSolver</a> (which uses the same strategy of elimination) and <a title="Numerical Algebraic Geometry" href="../../NumericalAlgebraicGeometry/html/index.html">NumericalAlgebraicGeometry</a> (which uses homotopy continuation).</p>
        </div>
        <div>
          <p>The next example computes the 31 nodes on a <a href="https://en.wikipedia.org/wiki/Togliatti_surface">Togliatti surface</a>. Over characteristic 0 the splitting field has degree 8 over <tt>QQ</tt>, so the computation isn't so heavy.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i28 : F = toField(QQ[q]/(q^4-10*q^2+20)); R = F[x,y,z,w];</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i30 : I = ideal &quot;64(x-w)(x4-4x3w-10x2y2-4x2w2+16xw3-20xy2w+5y4+16w4-20y2w2)-5q(2z-qw)(4(x2+y2-z2)+(1+3(5-q2))w2)2&quot;;

o30 : Ideal of R</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i31 : nodes = I + ideal jacobian I;

o31 : Ideal of R</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i32 : time rationalPoints(variety nodes, Split=>true, Verbose=>true);
-- base change to the field QQ[a]/(a^8-40*a^6+230*a^4-200*a^2+25)
     -- used 1.90398 seconds</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i33 : #oo

o33 = 31</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>Still it runs a lot faster when reduced to a positive characteristic.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i34 : nodes' = baseChange_32003 nodes;

o34 : Ideal of GF 1048969271299456081[x..z, w]</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i35 : time #rationalPoints(variety nodes', Split=>true, Verbose=>true)
     -- used 0.3031 seconds

o35 = 31</code></pre>
</td>          </tr>
        </table>
      </div>
      <div>
        <h2>Caveat</h2>
        <div>
          <p>For a number field other than <tt>QQ</tt>, the enumeration of elements with bounded height depends on an algorithm by Doyle–Krumm, which is currently only implemented in <tt>Sage</tt>.</p>
        </div>
      </div>
      <div class="waystouse">
        <h2>Ways to use <tt>rationalPoints</tt> :</h2>
        <ul>
          <li>
<tt>&quot;rationalPoints(AffineVariety)&quot;</tt>          </li>
          <li>
<tt>&quot;rationalPoints(Ideal)&quot;</tt>          </li>
          <li>
<tt>&quot;rationalPoints(ProjectiveVariety)&quot;</tt>          </li>
          <li>
<tt>&quot;rationalPoints(Ring,AffineVariety)&quot;</tt>          </li>
          <li>
<tt>&quot;rationalPoints(Ring,Ideal)&quot;</tt>          </li>
          <li>
<tt>&quot;rationalPoints(Ring,ProjectiveVariety)&quot;</tt>          </li>
        </ul>
      </div>
      <div class="waystouse">
        <h2>For the programmer</h2>
        <p>The object <a title="Find the rational points on a variety" href="_rational__Points.html">rationalPoints</a> is <span>a <a title="a type of method function" href="../../Macaulay2Doc/html/___Method__Function__With__Options.html">method function with options</a></span>.</p>
      </div>
      <div>
        <h3>Menu</h3>
        <ul>
          <li>
<span><a title="List the zeros of a polynomial" href="_zeros.html">zeros</a> -- List the zeros of a polynomial</span>          </li>
          <li>
<span><a title="Class of a projective point" href="___Projective__Point.html">ProjectivePoint</a> -- Class of a projective point</span>          </li>
          <li>
<span><a title="Multiplicative height function" href="_global__Height.html">globalHeight</a> -- Multiplicative height function</span>          </li>
        </ul>
      </div>
    </div>
  </body>

</html>
