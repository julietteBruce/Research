<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0 plus SVG 1.1//EN" "http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>randomPSD -- constructs a random positive semidefinite matrix</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <link type="text/css" rel="stylesheet" href="../../../../Macaulay2/Style/doc.css"/>

    <link rel="stylesheet" href="../../../../Macaulay2/Style/katex/katex.min.css" />
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/katex.min.js"></script>
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/auto-render.min.js"></script>
    <script defer="defer" type="text/javascript">
      var macros = {
          "\\break": "\\\\",
          "\\ZZ": "\\mathbb{Z}",
          "\\NN": "\\mathbb{N}",
          "\\QQ": "\\mathbb{Q}",
          "\\RR": "\\mathbb{R}",
          "\\CC": "\\mathbb{C}",
          "\\PP": "\\mathbb{P}"
      }, delimiters = [
          { left: "$$",  right: "$$",  display: true},
          { left: "\\[", right: "\\]", display: true},
          { left: "$",   right: "$",   display: false},
          { left: "\\(", right: "\\)", display: false}
      ], ignoredTags = ["tt", "script", "noscript", "style", "textarea", "pre", "code", "option"];
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, { delimiters: delimiters, macros: macros, ignoredTags: ignoredTags, trust: true });
      });
    </script>
    <style type="text/css">.katex { font-size: 1em; }</style>
    <link href="../../../../Macaulay2/Style/katex/contrib/copy-tex.min.css" rel="stylesheet" type="text/css" />
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/copy-tex.min.js"></script>
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/render-a11y-string.min.js"></script>
    <script type="text/javascript" src="../../../../Macaulay2/Style/highlight.js"></script>
  </head>
  <body>
    <table class="buttons">
      <tr>
<td>          <div>
<a href="_random__Unipotent.html">next</a> | <a href="_random__Orthogonal.html">previous</a> | <a href="_random__Unipotent.html">forward</a> | <a href="_random__Orthogonal.html">backward</a> | up | <a href="index.html">top</a> | <a href="master.html">index</a> | <a href="toc.html">toc</a> | <a href="http://macaulay2.com/">Macaulay2 website</a>          </div>
</td>      </tr>
    </table>
    <div>
<a title="computing determinantal representations of polynomials" href="index.html">DeterminantalRepresentations</a> :: <a title="constructs a random positive semidefinite matrix" href="_random__P__S__D.html">randomPSD</a>    </div>
    <hr/>
    <div>
      <h1>randomPSD -- constructs a random positive semidefinite matrix</h1>
      <div>
        <h2>Synopsis</h2>
        <ul>
          <li>
            <dl class="element">
              <dt>Usage: </dt>
              <dd><code class="language-macaulay2">randomPSD n</code></dd>
              <dd><code class="language-macaulay2">randomPSD(n, r)</code></dd>
              <dd><code class="language-macaulay2">randomPSD(n, s)</code></dd>
              <dd><code class="language-macaulay2">randomPSD(n, r, s)</code></dd>
            </dl>
          </li>
          <li>
Inputs:            <ul>
              <li>
<span><tt>n</tt>, <span>an <a title="the class of all integers" href="../../Macaulay2Doc/html/___Z__Z.html">integer</a></span>, the size of the output matrix</span>              </li>
              <li>
<span><tt>r</tt>, <span>an <a title="the class of all integers" href="../../Macaulay2Doc/html/___Z__Z.html">integer</a></span>, the desired rank</span>              </li>
              <li>
<span><tt>s</tt>, <span>a <a title="the class of all real numbers" href="../../Macaulay2Doc/html/___R__R.html">real number</a></span>, an upper bound on the spectral radius (= largest eigenvalue)</span>              </li>
            </ul>
          </li>
          <li>
Outputs:            <ul>
              <li>
<span><span>a <a title="the class of all matrices" href="../../Macaulay2Doc/html/___Matrix.html">matrix</a></span>, a random $n\times n$ positive semidefinite matrix with real entries, of rank $r$, with eigenvalues between $0$ and $s$.</span>              </li>
            </ul>
          </li>
        </ul>
      </div>
      <div>
        <h2>Description</h2>
        <div>
          <p>This method returns a random symmetric positive semidefinite real matrix of a given size $n$. The rank $r$ can also be specified: by default, the matrix will be full rank (with probability 1). An upper bound $s$ on the spectral radius can also be specified: by default, the matrix will have spectral radius $&lt;= 1$.</p>
          <p></p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i1 : randomPSD 5

o1 = | .585298   -.0545901 .0184505  -.0599728  -.149145   |
     | -.0545901 .761001   -.0118983 -.160458   -.02979    |
     | .0184505  -.0118983 .56512    .0605255   -.0250409  |
     | -.0599728 -.160458  .0605255  .609506    -.00367036 |
     | -.149145  -.02979   -.0250409 -.00367036 .761799    |

                5          5
o1 : Matrix RR    &lt;--- RR
              53         53</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i2 : A1 = randomPSD(5, 3)

o2 = | .0822059   .117626   -.109793  -.00518272 -.0292519 |
     | .117626    .168797   -.149976  -.0126384  -.0536067 |
     | -.109793   -.149976  .295902   -.204962   -.0805114 |
     | -.00518272 -.0126384 -.204962  .460442    -.0253618 |
     | -.0292519  -.0536067 -.0805114 -.0253618  .349651   |

                5          5
o2 : Matrix RR    &lt;--- RR
              53         53</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i3 : A2 = randomPSD(5, 3.0)

o3 = | .466141  -.549293  .0814037 .326059  -.171432  |
     | -.549293 2.32094   -.225548 -.826411 -.0874656 |
     | .0814037 -.225548  .538414  .404872  .190896   |
     | .326059  -.826411  .404872  .890458  .0658219  |
     | -.171432 -.0874656 .190896  .0658219 .577543   |

                5          5
o3 : Matrix RR    &lt;--- RR
              53         53</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i4 : (A1, A2)/eigenvectors -- note the difference!

o4 = (({.626892     }, | .162261  -.415623 .116326  -.4858  .73693   |),
       {.350611     }  | .218178  -.595049 .197553  .744075 .0836533 |  
       {.379495     }  | -.620177 .364839  .146256  .377851 .568316  |  
       {2.05527e-17 }  | .733874  .580879  .109056  .19276  .275985  |  
       {-1.76145e-17}  | .05366   -.051451 -.956116 .174422 .225357  |  
     ------------------------------------------------------------------------
     ({2.93272}, | .248943  -.183226 .443654  .667494  -.511935  |))
      {.851128}  | -.856474 .297886  .368634  .197344  .0536749  |
      {.637309}  | .163236  .62407   .206671  -.464468 -.57048   |
      {.178755}  | .419929  .422352  .467183  .138583  .638603   |
      {.193582}  | .0386539 .556639  -.637422 .52969   -.0421905 |

o4 : Sequence</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i5 : A3 = randomPSD(5, 3, 7.0)

o5 = | 1.20614   -.134804    -.0319069   -.60937  .0177087  |
     | -.134804  .16531      -.000970882 .12522   -.0189459 |
     | -.0319069 -.000970882 .0606769    -.175278 .226441   |
     | -.60937   .12522      -.175278    .932231  -.734734  |
     | .0177087  -.0189459   .226441     -.734734 .86079    |

                5          5
o5 : Matrix RR    &lt;--- RR
              53         53</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i6 : eigenvectors(A3, Hermitian => true)

o6 = ({-3.9607e-16}, | .329503  -.0611289 .179599  -.74438  .548938   |)
      {2.05251e-16}  | -.203212 .0191034  .97172   .0750933 -.0919877 |
      {.150772    }  | .0452739 -.975326  .0245115 .185606  .107882   |
      {1.08742    }  | .711759  -.0683418 .0981496 -.153387 -.674958  |
      {1.98696    }  | .584365  .199916   .115199  .618289  .472227   |

o6 : Sequence</code></pre>
</td>          </tr>
        </table>
      </div>
      <div>
        <h2>Caveat</h2>
        <div>
          <p>This method works by choosing the eigenvectors and eigenvalues independently randomly. The distribution on the (compact) set of PSD matrices of bounded spectral radius may not be uniform or statistically desirable (cf. Wishart distribution).</p>
        </div>
      </div>
      <div>
        <h2>See also</h2>
        <ul>
          <li>
<span><a title="computes the Cholesky decomposition of a positive semidefinite matrix" href="_cholesky.html">cholesky</a> -- computes the Cholesky decomposition of a positive semidefinite matrix</span>          </li>
        </ul>
      </div>
      <div class="waystouse">
        <h2>Ways to use <tt>randomPSD</tt> :</h2>
        <ul>
          <li>
<tt>&quot;randomPSD(ZZ)&quot;</tt>          </li>
          <li>
<tt>&quot;randomPSD(ZZ,RR)&quot;</tt>          </li>
          <li>
<tt>&quot;randomPSD(ZZ,ZZ)&quot;</tt>          </li>
          <li>
<tt>&quot;randomPSD(ZZ,ZZ,RR)&quot;</tt>          </li>
        </ul>
      </div>
      <div class="waystouse">
        <h2>For the programmer</h2>
        <p>The object <a title="constructs a random positive semidefinite matrix" href="_random__P__S__D.html">randomPSD</a> is <span>a <a title="a type of method function" href="../../Macaulay2Doc/html/___Method__Function.html">method function</a></span>.</p>
      </div>
    </div>
  </body>

</html>
