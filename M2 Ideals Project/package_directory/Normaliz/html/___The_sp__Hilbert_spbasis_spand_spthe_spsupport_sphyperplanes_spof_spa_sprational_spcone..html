<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0 plus SVG 1.1//EN" "http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>The Hilbert basis and the support hyperplanes of a rational cone.</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <link type="text/css" rel="stylesheet" href="../../../../Macaulay2/Style/doc.css"/>

    <link rel="stylesheet" href="../../../../Macaulay2/Style/katex/katex.min.css" />
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/katex.min.js"></script>
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/auto-render.min.js"></script>
    <script defer="defer" type="text/javascript">
      var macros = {
          "\\break": "\\\\",
          "\\ZZ": "\\mathbb{Z}",
          "\\NN": "\\mathbb{N}",
          "\\QQ": "\\mathbb{Q}",
          "\\RR": "\\mathbb{R}",
          "\\CC": "\\mathbb{C}",
          "\\PP": "\\mathbb{P}"
      }, delimiters = [
          { left: "$$",  right: "$$",  display: true},
          { left: "\\[", right: "\\]", display: true},
          { left: "$",   right: "$",   display: false},
          { left: "\\(", right: "\\)", display: false}
      ], ignoredTags = ["tt", "script", "noscript", "style", "textarea", "pre", "code", "option"];
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, { delimiters: delimiters, macros: macros, ignoredTags: ignoredTags, trust: true });
      });
    </script>
    <style type="text/css">.katex { font-size: 1em; }</style>
    <link href="../../../../Macaulay2/Style/katex/contrib/copy-tex.min.css" rel="stylesheet" type="text/css" />
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/copy-tex.min.js"></script>
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/render-a11y-string.min.js"></script>
    <script type="text/javascript" src="../../../../Macaulay2/Style/highlight.js"></script>
  </head>
  <body>
    <table class="buttons">
      <tr>
<td>          <div>
<a href="___The_splattice_sppoints_cm_sp__Ehrhart_spseries_spand_spthe_spsupport_sphyperplanes_spof_span_spintegral_sppolytope..html">next</a> | <a href="___The_spgenerators_spof_spthe_spintegral_spclosure_spof_spthe_sp__Rees_spalgebra_spof_spa_spmonomial_spideal..html">previous</a> | <a href="___The_splattice_sppoints_cm_sp__Ehrhart_spseries_spand_spthe_spsupport_sphyperplanes_spof_span_spintegral_sppolytope..html">forward</a> | <a href="___The_spgenerators_spof_spthe_spintegral_spclosure_spof_spthe_sp__Rees_spalgebra_spof_spa_spmonomial_spideal..html">backward</a> | up | <a href="index.html">top</a> | <a href="master.html">index</a> | <a href="toc.html">toc</a> | <a href="http://macaulay2.com/">Macaulay2 website</a>          </div>
</td>      </tr>
    </table>
    <div>
<a title="an interface to use Normaliz in Macaulay 2" href="index.html">Normaliz</a> :: <a href="___The_sp__Hilbert_spbasis_spand_spthe_spsupport_sphyperplanes_spof_spa_sprational_spcone..html">The Hilbert basis and the support hyperplanes of a rational cone.</a>    </div>
    <hr/>
    <div>
      <h1>The Hilbert basis and the support hyperplanes of a rational cone.</h1>
      <div>
We want to calculate the Hilbert basis of a rational cone.  The cone may be given by         <ul>
          <li>
a system of generators;          </li>
          <li>
a linear system of inequalities;          </li>
          <li>
a linear system of equations.          </li>
        </ul>
        <p/>
First of all consider the cone generated by the 16 vectors        <pre>
 1 0 0 0 0 0 0             1 0 1 0 1 0 1
 0 1 0 0 0 0 0             1 0 0 1 0 1 1
 0 0 1 0 0 0 0             1 0 0 0 1 1 1
 0 0 0 1 0 0 0             0 1 1 0 0 1 1
 0 0 0 0 1 0 0             0 1 0 1 1 0 1
 0 0 0 0 0 1 0             0 1 0 0 1 1 1
 1 1 1 0 0 0 1             0 0 1 1 1 0 1
 1 1 0 1 0 0 1             0 0 1 1 0 1 1
</pre>
        <p/>
in dimension 7. We compute its integral closure  in the ambient lattice \ZZ^7. The fastest way is applying the function <a title="integral closure of a toric ring" href="_intcl__Toric__Ring.html">intclToricRing</a> to the ideal that is generated by the monomials whose exponent vectors are the generators of the cone (to compute it in the group of the monoid generated by these vectors use <a title="normalization of a toric ring" href="_normal__Toric__Ring.html">normalToricRing</a>) .        <p/>
One can convert the vectors to monomials in the following way:        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i1 : R=ZZ/37[x_1..x_7];</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i2 : l={{1, 0, 0, 0, 0, 0, 0},
        {0, 1, 0, 0, 0, 0, 0},
        {0, 0, 1, 0, 0, 0, 0},
        {0, 0, 0, 1, 0, 0, 0},
        {0, 0, 0, 0, 1, 0, 0},
        {0, 0, 0, 0, 0, 1, 0},
        {1, 1, 1, 0, 0, 0, 1},
        {1, 1, 0, 1, 0, 0, 1},
        {1, 0, 1, 0, 1, 0, 1},
        {1, 0, 0, 1, 0, 1, 1},
        {1, 0, 0, 0, 1, 1, 1},
        {0, 1, 1, 0, 0, 1, 1},
        {0, 1, 0, 1, 1, 0, 1},
        {0, 1, 0, 0, 1, 1, 1},
        {0, 0, 1, 1, 1, 0, 1},
        {0, 0, 1, 1, 0, 1, 1}};</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i3 : L=for i in l list R_i

o3 = {x , x , x , x , x , x , x x x x , x x x x , x x x x , x x x x ,
       1   2   3   4   5   6   1 2 3 7   1 2 4 7   1 3 5 7   1 4 6 7 
     ------------------------------------------------------------------------
     x x x x , x x x x , x x x x , x x x x , x x x x , x x x x }
      1 5 6 7   2 3 6 7   2 4 5 7   2 5 6 7   3 4 5 7   3 4 6 7

o3 : List</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i4 : S=intclToricRing L

     ZZ                                                                                                                                          2
o4 = --[x , x , x , x , x x x x , x x x x , x , x x x x , x x x x , x x x x , x , x x x x , x x x x , x x x x , x x x x , x x x x , x x x x x x x ]
     37  6   5   4   3   3 4 6 7   3 4 5 7   2   2 5 6 7   2 4 5 7   2 3 6 7   1   1 5 6 7   1 4 6 7   1 3 5 7   1 2 4 7   1 2 3 7   1 2 3 4 5 6 7

o4 : monomial subalgebra of R</code></pre>
</td>          </tr>
        </table>
        <p/>
The function <a title="integral closure of a toric ring" href="_intcl__Toric__Ring.html">intclToricRing</a> returns a <a title="class of monomial subalgebras" href="___Monomial__Subalgebra.html">MonomialSubalgebra</a>. The Hilbert basis of the cone consists of the exponent vectors of the generators of the subalgebra. The generators can be extracted with <a title="provide matrix or list of generators" href="../../Macaulay2Doc/html/_generators.html">generators</a>.        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i5 : hb = flatten \ exponents \  gens S

o5 = {{0, 0, 0, 0, 0, 1, 0}, {0, 0, 0, 0, 1, 0, 0}, {0, 0, 0, 1, 0, 0, 0},
     ------------------------------------------------------------------------
     {0, 0, 1, 0, 0, 0, 0}, {0, 0, 1, 1, 0, 1, 1}, {0, 0, 1, 1, 1, 0, 1}, {0,
     ------------------------------------------------------------------------
     1, 0, 0, 0, 0, 0}, {0, 1, 0, 0, 1, 1, 1}, {0, 1, 0, 1, 1, 0, 1}, {0, 1,
     ------------------------------------------------------------------------
     1, 0, 0, 1, 1}, {1, 0, 0, 0, 0, 0, 0}, {1, 0, 0, 0, 1, 1, 1}, {1, 0, 0,
     ------------------------------------------------------------------------
     1, 0, 1, 1}, {1, 0, 1, 0, 1, 0, 1}, {1, 1, 0, 1, 0, 0, 1}, {1, 1, 1, 0,
     ------------------------------------------------------------------------
     0, 0, 1}, {1, 1, 1, 1, 1, 1, 2}}

o5 : List</code></pre>
</td>          </tr>
        </table>
        <p/>
It is also possible to call <tt>Normaliz</tt> directly to do this computation by using the function <a title="calls Normaliz" href="_normaliz.html">normaliz</a>. It takes as input the matrix containing the generators as rows, and the type for the computation.        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i6 : M=matrix l;

              16        7
o6 : Matrix ZZ   &lt;--- ZZ</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i7 : d=(normaliz(M,&quot;normalization&quot;))#&quot;gen&quot;

o7 = | 0 0 0 0 0 1 0 |
     | 0 0 0 0 1 0 0 |
     | 0 0 0 1 0 0 0 |
     | 0 0 1 0 0 0 0 |
     | 0 0 1 1 0 1 1 |
     | 0 0 1 1 1 0 1 |
     | 0 1 0 0 0 0 0 |
     | 0 1 0 0 1 1 1 |
     | 0 1 0 1 1 0 1 |
     | 0 1 1 0 0 1 1 |
     | 1 0 0 0 0 0 0 |
     | 1 0 0 0 1 1 1 |
     | 1 0 0 1 0 1 1 |
     | 1 0 1 0 1 0 1 |
     | 1 1 0 1 0 0 1 |
     | 1 1 1 0 0 0 1 |
     | 1 1 1 1 1 1 2 |

              17        7
o7 : Matrix ZZ   &lt;--- ZZ</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i8 : set entries d===set hb

o8 = true</code></pre>
</td>          </tr>
        </table>
        <p/>
The result is an object of type <a title="class of rational cones" href="___Rational__Cone.html">RationalCone</a> from which you obtain the Hilbert basis via the key &quot;gen&quot;.        <p/>
The support hyperplanes are stored in the <tt>Normaliz</tt> file &lt;filename>.sup. To inspect these, one has to assure that the computations by <tt>Normaliz</tt> are kept. This can be done by specifying a filename, that is, assigning a non-empty string to the global variable <a title="global variable holding the filename" href="_nmz__Filename.html">nmzFilename</a>, see also <a href="___Keeping_spresults_spof_spthe_spcomputation_spby_sp__Normaliz.html">Keeping results of the computation by Normaliz</a>. Then use <a title="reads an output file of Normaliz containing one matrix" href="_read__Nmz__Data.html">readNmzData</a> to read the .sup file.        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i9 : nmzFilename=&quot;rproj2&quot;;</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i10 : intclToricRing L;</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i11 : hypes=readNmzData(&quot;sup&quot;)

o11 = | 0 0 0 0 0 0 1  |
      | 0 0 0 0 0 1 0  |
      | 0 0 0 0 1 0 0  |
      | 0 0 0 1 0 0 0  |
      | 0 0 1 0 0 0 0  |
      | 0 0 1 1 0 1 -1 |
      | 0 0 1 1 1 0 -1 |
      | 0 1 0 0 0 0 0  |
      | 0 1 0 0 1 1 -1 |
      | 0 1 0 1 1 0 -1 |
      | 0 1 1 0 0 1 -1 |
      | 0 1 1 1 1 1 -2 |
      | 1 0 0 0 0 0 0  |
      | 1 0 0 0 1 1 -1 |
      | 1 0 0 1 0 1 -1 |
      | 1 0 1 0 1 0 -1 |
      | 1 0 1 1 1 1 -2 |
      | 1 1 0 1 0 0 -1 |
      | 1 1 0 1 1 1 -2 |
      | 1 1 1 0 0 0 -1 |
      | 1 1 1 0 1 1 -2 |
      | 1 1 1 1 0 1 -2 |
      | 1 1 1 1 1 0 -2 |
      | 1 1 1 1 1 1 -3 |

               24        7
o11 : Matrix ZZ   &lt;--- ZZ</code></pre>
</td>          </tr>
        </table>
        <p/>
This means there are 24 support hyperplanes in \ZZ^7. So in contrast to the convention of M2 Normaliz writes vectors as rows. If you don't want to keep the results of the computations any longer, use <a title="removes the files created by Normaliz" href="_rm__Nmz__Files.html">rmNmzFiles</a> to delete the files created by <tt>Normaliz</tt>.        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i12 : rmNmzFiles();</code></pre>
</td>          </tr>
        </table>
        <hr/>
        <p/>
Conversely, suppose the cone is given by the above hyperplanes. In that case, to compute the Hilbert basis, you should use <tt>Normaliz</tt> in type inequalities. The result is an object of type <a title="class of rational cones" href="___Rational__Cone.html">RationalCone</a>. The Hilbert basis is accessible via the key &quot;gen&quot;. Not surprisingly, it is the same Hilbert basis as above (but in another order).        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i13 : normaliz(hypes,&quot;inequalities&quot;)

o13 = RationalCone{gen => | 0 0 0 0 0 1 0 |                                       }
                          | 0 0 0 0 1 0 0 |
                          | 0 0 0 1 0 0 0 |
                          | 0 0 1 0 0 0 0 |
                          | 0 0 1 1 0 1 1 |
                          | 0 0 1 1 1 0 1 |
                          | 0 1 0 0 0 0 0 |
                          | 0 1 0 0 1 1 1 |
                          | 0 1 0 1 1 0 1 |
                          | 0 1 1 0 0 1 1 |
                          | 1 0 0 0 0 0 0 |
                          | 1 0 0 0 1 1 1 |
                          | 1 0 0 1 0 1 1 |
                          | 1 0 1 0 1 0 1 |
                          | 1 1 0 1 0 0 1 |
                          | 1 1 1 0 0 0 1 |
                          | 1 1 1 1 1 1 2 |
                   inv => HashTable{ => (1, 1, 1, 1, 1, 1, 1)                    }
                                    class group => 1 : (17)
                                    degree 1 elements => 16
                                    dim max subspace => 0
                                    embedding dim => 7
                                    external index => 1
                                    graded => true
                                    grading denom => 1
                                    grading => (1, 1, 1, 1, 1, 1, -2)
                                    hilbert basis elements => 17
                                    hilbert quasipolynomial denom => 60
                                    hilbert series denom => (1, 1, 1, 1, 1, 1, 1)
                                    hilbert series num => (1, 9, 31, 25, 6)
                                    inhomogeneous => false
                                    multiplicity denom => 1
                                    multiplicity => 72
                                    number extreme rays => 16
                                    number support hyperplanes => 24
                                    rank => 7
                                    size triangulation => 69
                                    sum dets => 72

o13 : RationalCone</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i14 : set entries oo#&quot;gen&quot;===set hb

o14 = true</code></pre>
</td>          </tr>
        </table>
        <p/>
Note that for the comparison <a title="make a set" href="../../Macaulay2Doc/html/_set.html">set</a> has to be used because the order of the generators may differ.        <hr/>
        <p/>
To illustrate the third possibility we compute the Hilbert basis of the cone given by the equations         <pre>
1 1 1 -1 -1 -1  0  0  0
1 1 1  0  0  0 -1 -1 -1
0 1 1 -1  0  0 -1  0  0
1 0 1  0 -1  0  0 -1  0
1 1 0  0  0 -1  0  0 -1
0 1 1  0 -1  0  0  0 -1
1 1 0  0 -1  0 -1  0  0
</pre>
        <p/>
(this is the solution cone for a 3x3 magic square). To this end one has to choose type 5.        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i15 : eq=matrix {{1, 1, 1, -1, -1, -1,  0,  0,  0}, {1, 1, 1,  0,  0,  0, -1, -1, -1}, {0, 1, 1, -1,  0,  0, -1,  0,  0}, {1, 0, 1,  0, -1,  0,  0, -1,  0}, {1, 1, 0,  0,  0, -1,  0,  0, -1}, {0, 1, 1,  0, -1,  0,  0,  0, -1}, {1, 1, 0,  0, -1,  0, -1,  0,  0}};

               7        9
o15 : Matrix ZZ  &lt;--- ZZ</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i16 : normaliz(eq,&quot;equations&quot;)

o16 = RationalCone{gen => | 0 2 1 2 1 0 1 0 2 |                            }
                          | 1 0 2 2 1 0 0 2 1 |
                          | 1 1 1 1 1 1 1 1 1 |
                          | 1 2 0 0 1 2 2 0 1 |
                          | 2 0 1 0 1 2 1 2 0 |
                   inv => HashTable{ => (1, 1, 1)                         }
                                    class group => (1, 2, 2)
                                    degree 1 elements => 5
                                    dim max subspace => 0
                                    embedding dim => 9
                                    external index => 1
                                    graded => true
                                    grading denom => 3
                                    grading => (1, 1, 1, 0, 0, 0, 0, 0, 0)
                                    hilbert basis elements => 5
                                    hilbert quasipolynomial denom => 1
                                    hilbert series denom => (1, 1, 1)
                                    hilbert series num => (1, 2, 1)
                                    inhomogeneous => false
                                    multiplicity denom => 1
                                    multiplicity => 4
                                    number extreme rays => 4
                                    number support hyperplanes => 4
                                    rank => 3
                                    size triangulation => 2
                                    sum dets => 4

o16 : RationalCone</code></pre>
</td>          </tr>
        </table>
Again the rows of this matrix are the elements of the Hilbert basis.      </div>
    </div>
  </body>

</html>
