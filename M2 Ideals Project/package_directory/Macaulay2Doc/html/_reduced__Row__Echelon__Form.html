<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0 plus SVG 1.1//EN" "http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>reducedRowEchelonForm -- compute the reduced row echelon form of a matrix or mutable matrix over a field</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <link type="text/css" rel="stylesheet" href="../../../../Macaulay2/Style/doc.css"/>

    <link rel="stylesheet" href="../../../../Macaulay2/Style/katex/katex.min.css" />
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/katex.min.js"></script>
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/auto-render.min.js"></script>
    <script defer="defer" type="text/javascript">
      var macros = {
          "\\break": "\\\\",
          "\\ZZ": "\\mathbb{Z}",
          "\\NN": "\\mathbb{N}",
          "\\QQ": "\\mathbb{Q}",
          "\\RR": "\\mathbb{R}",
          "\\CC": "\\mathbb{C}",
          "\\PP": "\\mathbb{P}"
      }, delimiters = [
          { left: "$$",  right: "$$",  display: true},
          { left: "\\[", right: "\\]", display: true},
          { left: "$",   right: "$",   display: false},
          { left: "\\(", right: "\\)", display: false}
      ], ignoredTags = ["tt", "script", "noscript", "style", "textarea", "pre", "code", "option"];
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, { delimiters: delimiters, macros: macros, ignoredTags: ignoredTags, trust: true });
      });
    </script>
    <style type="text/css">.katex { font-size: 1em; }</style>
    <link href="../../../../Macaulay2/Style/katex/contrib/copy-tex.min.css" rel="stylesheet" type="text/css" />
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/copy-tex.min.js"></script>
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/render-a11y-string.min.js"></script>
    <script type="text/javascript" src="../../../../Macaulay2/Style/highlight.js"></script>
  </head>
  <body>
    <table class="buttons">
      <tr>
<td>          <div>
<a href="_regularity.html">next</a> | <a href="_recursion__Limit.html">previous</a> | <a href="_regularity.html">forward</a> | <a href="_recursion__Limit.html">backward</a> | up | <a href="index.html">top</a> | <a href="master.html">index</a> | <a href="toc.html">toc</a> | <a href="http://macaulay2.com/">Macaulay2 website</a>          </div>
</td>      </tr>
    </table>
    <div>
<a title="Macaulay2 documentation" href="index.html">Macaulay2Doc</a> :: <a title="compute the reduced row echelon form of a matrix or mutable matrix over a field" href="_reduced__Row__Echelon__Form.html">reducedRowEchelonForm</a>    </div>
    <hr/>
    <div>
      <h1>reducedRowEchelonForm -- compute the reduced row echelon form of a matrix or mutable matrix over a field</h1>
      <div>
        <h2>Synopsis</h2>
        <ul>
          <li>
            <dl class="element">
              <dt>Usage: </dt>
              <dd><code class="language-macaulay2">R = reducedRowEchelonForm A</code></dd>
            </dl>
          </li>
          <li>
Inputs:            <ul>
              <li>
<span><tt>A</tt>, <span>a <a title="the class of all matrices" href="___Matrix.html">matrix</a></span>, or <span>a <a title="the class of all mutable matrices" href="___Mutable__Matrix.html">mutable matrix</a></span>, a matrix over eiither a finite field or the rationals</span>              </li>
            </ul>
          </li>
          <li>
Outputs:            <ul>
              <li>
<span><tt>R</tt>, <span>a <a title="the class of all matrices" href="___Matrix.html">matrix</a></span>, or <span>a <a title="the class of all mutable matrices" href="___Mutable__Matrix.html">mutable matrix</a></span>, the same type as <tt>A</tt>, the reduced row echelon form of <tt>A</tt></span>              </li>
            </ul>
          </li>
        </ul>
      </div>
      <div>
        <h2>Description</h2>
        <div>
          <p>A matrix over a field is in reduced row echelon form if (1) all rows consisting only of zeros are at the bottom, (2) the leading coefficient  (called the pivot) of a nonzero row is always strictly to the right of the leading coefficient of the row above it, and (3) the leading coefficient of each nonzero row is 1.  See <a href="https://en.wikipedia.org/wiki/Row_echelon_form">Row echelon form</a> for more discussion.</p>
          <p>Given a matrix <tt>A</tt> (over a field), there is a unique matrix <tt>R</tt> such that (1) the row spans of <tt>A</tt> and <tt>R</tt> are the same, and (2) <tt>R</tt> is in reduced row echelon form.</p>
          <p>If the matrix <tt>A</tt> is over either a finite field, or the rationals, then this returns the unique reduced row echelon form for the matrix, which is unique.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i1 : R0 = matrix(QQ, {{1,0,3,0,5},{0,1,-2,0,2},{0,0,0,1,7}})

o1 = | 1 0 3  0 5 |
     | 0 1 -2 0 2 |
     | 0 0 0  1 7 |

              3        5
o1 : Matrix QQ  &lt;--- QQ</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i2 : B = matrix(QQ, {{1,2,3},{0,3,-1},{1,2,0}})

o2 = | 1 2 3  |
     | 0 3 -1 |
     | 1 2 0  |

              3        3
o2 : Matrix QQ  &lt;--- QQ</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i3 : A = B * R0

o3 = | 1 2 -1 3  30 |
     | 0 3 -6 -1 -1 |
     | 1 2 -1 0  9  |

              3        5
o3 : Matrix QQ  &lt;--- QQ</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i4 : R = reducedRowEchelonForm A

o4 = | 1 0 3  0 5 |
     | 0 1 -2 0 2 |
     | 0 0 0  1 7 |

              3        5
o4 : Matrix QQ  &lt;--- QQ</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i5 : assert(R == R0)</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i6 : LUdecomposition A

o6 = ({0, 1, 2}, | 1 0 0 |, | -1/9 -2/9 1/9 -1/3 -10/3 |)
                 | 0 1 0 |  | 0    -1/3 2/3 1/9  1/9   |
                 | 1 0 1 |  | 0    0    0   1    7     |

o6 : Sequence</code></pre>
</td>          </tr>
        </table>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i7 : A5 = sub(A, ZZ/5)

o7 = | 1 2  -1 -2 0  |
     | 0 -2 -1 -1 -1 |
     | 1 2  -1 0  -1 |

             ZZ 3       ZZ 5
o7 : Matrix (--)  &lt;--- (--)
              5          5</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i8 : reducedRowEchelonForm A5

o8 = | 1 0 -2 0 0 |
     | 0 1 -2 0 2 |
     | 0 0 0  1 2 |

             ZZ 3       ZZ 5
o8 : Matrix (--)  &lt;--- (--)
              5          5</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i9 : rank A5

o9 = 3</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>This function is useful while learning the concepts and algorithms of linear algebra.  In practice though, one tends to use LU decompositions rather than reduced row echelon forms.</p>
          <p>In fact, this function doesn't work over the reals or complexes (due to often poor numerical stability), as an LU decomposition is better for solving systems over the real numbers.  If numerical stability is an issue, using a singular value decomposition (SVD) is also a good idea.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i10 : AR = sub(A, RR)

o10 = | 1 2 -1 3  30 |
      | 0 3 -6 -1 -1 |
      | 1 2 -1 0  9  |

                 3          5
o10 : Matrix RR    &lt;--- RR
               53         53</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i11 : LUdecomposition AR

o11 = ({0, 1, 2}, | 1 0 0 |, | 1 2 -1 3  30  |)
                  | 0 1 0 |  | 0 3 -6 -1 -1  |
                  | 1 0 1 |  | 0 0 0  -3 -21 |

o11 : Sequence</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i12 : SVD AR

o12 = ({31.6062}, | -.956949 .0376118 -.287807 |, | -.0394384 -.0769597
       {6.95666}  | .0201977 -.980536 -.195297 |  | -.0222938 -.467435 
       {1.28466}  | -.289551 -.192702 .937564  |  | .505782   .555496  
                                                  | .0471081  .572207  
                                                  | -.860182  .373609  
      -----------------------------------------------------------------------
      .0356042 -.0914707 -.991407   |)
      .86799   .157169   .0538433   |
      .406354  -.520081  -.00066372 |
      .172926  .792242   -.113177   |
      .224276  -.262297  .037471    |

o12 : Sequence</code></pre>
</td>          </tr>
        </table>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i13 : AC = sub(A, CC)

o13 = | 1 2 -1 3  30 |
      | 0 3 -6 -1 -1 |
      | 1 2 -1 0  9  |

                 3          5
o13 : Matrix CC    &lt;--- CC
               53         53</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i14 : LUdecomposition AC

o14 = ({0, 1, 2}, | 1 0 0 |, | 1 2 -1 3  30  |)
                  | 0 1 0 |  | 0 3 -6 -1 -1  |
                  | 1 0 1 |  | 0 0 0  -3 -21 |

o14 : Sequence</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i15 : SVD AC

o15 = ({31.6062}, | -.956949 .0376118 -.287807 |, | -.0394384 -.0769597
       {6.95666}  | .0201977 -.980536 -.195297 |  | -.0222938 -.467435 
       {1.28466}  | -.289551 -.192702 .937564  |  | .505782   .555496  
                                                  | .0471081  .572207  
                                                  | -.860182  .373609  
      -----------------------------------------------------------------------
      .0356042 -.0914707 -.991407   |)
      .86799   .157169   .0538433   |
      .406354  -.520081  -.00066372 |
      .172926  .792242   -.113177   |
      .224276  -.262297  .037471    |

o15 : Sequence</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>This function also works over finite fields.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i16 : A9 = sub(A, GF 9)

o16 = | 1 -1 -1 0  0  |
      | 0 0  0  -1 -1 |
      | 1 -1 -1 0  0  |

                   3            5
o16 : Matrix (GF 9)  &lt;--- (GF 9)</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i17 : R9 = reducedRowEchelonForm A9

o17 = | 1 -1 -1 0 0 |
      | 0 0  0  1 1 |
      | 0 0  0  0 0 |

                   3            5
o17 : Matrix (GF 9)  &lt;--- (GF 9)</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>It is not yet implemented over fraction fields and extension fields. Use <a title="LU decomposition" href="___L__Udecomposition.html">LUdecomposition</a> instead.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i18 : S = frac(QQ[x])

o18 = S

o18 : FractionField</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i19 : R = matrix(S, {{1,0,x,0,x^2+1},{0,1,-1/x,0,2*x},{0,0,0,1,7*x}})

o19 = | 1 0 x      0 x2+1 |
      | 0 1 (-1)/x 0 2x   |
      | 0 0 0      1 7x   |

              3       5
o19 : Matrix S  &lt;--- S</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i20 : B = matrix(S, {{1,2*x,3},{0,3,-x},{1,2*x^2,0}})

o20 = | 1 2x  3  |
      | 0 3   -x |
      | 1 2x2 0  |

              3       3
o20 : Matrix S  &lt;--- S</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i21 : A = B * R

o21 = | 1 2x  x-2    3  5x2+21x+1 |
      | 0 3   (-3)/x -x -7x2+6x   |
      | 1 2x2 -x     0  4x3+x2+1  |

              3       5
o21 : Matrix S  &lt;--- S</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i22 : LUdecomposition A

o22 = ({0, 1, 2}, | 1 0          0 |, | 1 2x x-2    3            
                  | 0 1          0 |  | 0 3  (-3)/x -x           
                  | 1 (2x2-2x)/3 1 |  | 0 0  0      (2x3-2x2-9)/3
      -----------------------------------------------------------------------
      5x2+21x+1         |)
      -7x2+6x           |
      (14x4-14x3-63x)/3 |

o22 : Sequence</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>Even though it is not implemented currently as a canned routine, we can put <tt>A</tt> into reduced row echelon form using elementary row operations.  Recall that rows and columns in Macaulay2 are indexed starting with 0.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i23 : M = mutableMatrix A

o23 = | 1 2x  x-2    3  5x2+21x+1 |
      | 0 3   (-3)/x -x -7x2+6x   |
      | 1 2x2 -x     0  4x3+x2+1  |

o23 : MutableMatrix</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i24 : rowAdd(M, 2, -1, 0)

o24 = | 1 2x     x-2    3  5x2+21x+1   |
      | 0 3      (-3)/x -x -7x2+6x     |
      | 0 2x2-2x -2x+2  -3 4x3-4x2-21x |

o24 : MutableMatrix</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i25 : rowMult(M, 1, 1/M_(1,1))

o25 = | 1 2x     x-2    3      5x2+21x+1   |
      | 0 1      (-1)/x (-x)/3 (-7x2+6x)/3 |
      | 0 2x2-2x -2x+2  -3     4x3-4x2-21x |

o25 : MutableMatrix</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i26 : rowAdd(M, 2, -M_(2,1), 1)

o26 = | 1 2x x-2    3             5x2+21x+1         |
      | 0 1  (-1)/x (-x)/3        (-7x2+6x)/3       |
      | 0 0  0      (2x3-2x2-9)/3 (14x4-14x3-63x)/3 |

o26 : MutableMatrix</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i27 : rowMult(M, 2, 1/M_(2,3))

o27 = | 1 2x x-2    3      5x2+21x+1   |
      | 0 1  (-1)/x (-x)/3 (-7x2+6x)/3 |
      | 0 0  0      1      7x          |

o27 : MutableMatrix</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>At this point the matrix is in row echelon form. We clear out the entries above the pivots to place it into reduced row echelon form.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i28 : rowAdd(M, 0, -M_(0,1), 1)

o28 = | 1 0 x      (2x2+9)/3 (14x3+3x2+63x+3)/3 |
      | 0 1 (-1)/x (-x)/3    (-7x2+6x)/3        |
      | 0 0 0      1         7x                 |

o28 : MutableMatrix</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i29 : rowAdd(M, 0, -M_(0,3), 2)

o29 = | 1 0 x      0      x2+1        |
      | 0 1 (-1)/x (-x)/3 (-7x2+6x)/3 |
      | 0 0 0      1      7x          |

o29 : MutableMatrix</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i30 : rowAdd(M, 1, -M_(1,3), 2)

o30 = | 1 0 x      0 x2+1 |
      | 0 1 (-1)/x 0 2x   |
      | 0 0 0      1 7x   |

o30 : MutableMatrix</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i31 : assert(R == matrix M)</code></pre>
</td>          </tr>
        </table>
      </div>
      <div>
        <h2>See also</h2>
        <ul>
          <li>
<span><a title="add a multiple of one row to another" href="_row__Add.html">rowAdd</a> -- add a multiple of one row to another</span>          </li>
          <li>
<span><a title="multiply a row by a ring element" href="_row__Mult.html">rowMult</a> -- multiply a row by a ring element</span>          </li>
          <li>
<span><a title="permute some rows" href="_row__Permute.html">rowPermute</a> -- permute some rows</span>          </li>
          <li>
<span><a title="interchange rows" href="_row__Swap.html">rowSwap</a> -- interchange rows</span>          </li>
          <li>
<span><a title="LU decomposition" href="___L__Udecomposition.html">LUdecomposition</a> -- LU decomposition</span>          </li>
          <li>
<span><a title="singular value decomposition of a matrix" href="___S__V__D.html">SVD</a> -- singular value decomposition of a matrix</span>          </li>
          <li>
<span><a title="compute the rank" href="_rank.html">rank(Matrix)</a> -- compute the rank</span>          </li>
        </ul>
      </div>
      <div class="waystouse">
        <h2>Ways to use <tt>reducedRowEchelonForm</tt> :</h2>
        <ul>
          <li>
<tt>&quot;reducedRowEchelonForm(Matrix)&quot;</tt>          </li>
          <li>
<tt>&quot;reducedRowEchelonForm(MutableMatrix)&quot;</tt>          </li>
        </ul>
      </div>
      <div class="waystouse">
        <h2>For the programmer</h2>
        <p>The object <a title="compute the reduced row echelon form of a matrix or mutable matrix over a field" href="_reduced__Row__Echelon__Form.html">reducedRowEchelonForm</a> is <span>a <a title="a type of method function" href="___Method__Function.html">method function</a></span>.</p>
      </div>
    </div>
  </body>

</html>
