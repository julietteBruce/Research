<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0 plus SVG 1.1//EN" "http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>frobeniusNu -- computes the largest power of an ideal not contained in a specified Frobenius power</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <link type="text/css" rel="stylesheet" href="../../../../Macaulay2/Style/doc.css"/>

    <link rel="stylesheet" href="../../../../Macaulay2/Style/katex/katex.min.css" />
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/katex.min.js"></script>
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/auto-render.min.js"></script>
    <script defer="defer" type="text/javascript">
      var macros = {
          "\\break": "\\\\",
          "\\ZZ": "\\mathbb{Z}",
          "\\NN": "\\mathbb{N}",
          "\\QQ": "\\mathbb{Q}",
          "\\RR": "\\mathbb{R}",
          "\\CC": "\\mathbb{C}",
          "\\PP": "\\mathbb{P}"
      }, delimiters = [
          { left: "$$",  right: "$$",  display: true},
          { left: "\\[", right: "\\]", display: true},
          { left: "$",   right: "$",   display: false},
          { left: "\\(", right: "\\)", display: false}
      ], ignoredTags = ["tt", "script", "noscript", "style", "textarea", "pre", "code", "option"];
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, { delimiters: delimiters, macros: macros, ignoredTags: ignoredTags, trust: true });
      });
    </script>
    <style type="text/css">.katex { font-size: 1em; }</style>
    <link href="../../../../Macaulay2/Style/katex/contrib/copy-tex.min.css" rel="stylesheet" type="text/css" />
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/copy-tex.min.js"></script>
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/render-a11y-string.min.js"></script>
    <script type="text/javascript" src="../../../../Macaulay2/Style/highlight.js"></script>
  </head>
  <body>
    <table class="buttons">
      <tr>
<td>          <div>
<a href="___Frobenius__Power.html">next</a> | <a href="_fpt.html">previous</a> | <a href="___Frobenius__Power.html">forward</a> | <a href="_fpt.html">backward</a> | up | <a href="index.html">top</a> | <a href="master.html">index</a> | <a href="toc.html">toc</a> | <a href="http://macaulay2.com/">Macaulay2 website</a>          </div>
</td>      </tr>
    </table>
    <div>
<a title="a package for computing F-pure thresholds and related invariants" href="index.html">FrobeniusThresholds</a> :: <a title="computes the largest power of an ideal not contained in a specified Frobenius power" href="_frobenius__Nu.html">frobeniusNu</a>    </div>
    <hr/>
    <div>
      <h1>frobeniusNu -- computes the largest power of an ideal not contained in a specified Frobenius power</h1>
      <div>
        <h2>Synopsis</h2>
        <ul>
          <li>
            <dl class="element">
              <dt>Usage: </dt>
              <dd><code class="language-macaulay2">frobeniusNu(e, I, J)</code></dd>
              <dd><code class="language-macaulay2">frobeniusNu(e, I)</code></dd>
              <dd><code class="language-macaulay2">frobeniusNu(e, f, J)</code></dd>
              <dd><code class="language-macaulay2">frobeniusNu(e, f)</code></dd>
            </dl>
          </li>
          <li>
Inputs:            <ul>
              <li>
<span><tt>e</tt>, <span>an <a title="the class of all integers" href="../../Macaulay2Doc/html/___Z__Z.html">integer</a></span>, the order of the Frobenius power to consider</span>              </li>
              <li>
<span><tt>I</tt>, <span>an <a title="the class of all ideals" href="../../Macaulay2Doc/html/___Ideal.html">ideal</a></span>, in a polynomial ring $R$ over a finite field of characteristic $p$</span>              </li>
              <li>
<span><tt>f</tt>, <span>a <a title="the class of all ring elements handled by the engine" href="../../Macaulay2Doc/html/___Ring__Element.html">ring element</a></span>, in the polynomial ring $R$</span>              </li>
              <li>
<span><tt>J</tt>, <span>an <a title="the class of all ideals" href="../../Macaulay2Doc/html/___Ideal.html">ideal</a></span>, in the polynomial ring $R$; if omitted, <tt>J</tt> is assumed to be the ideal generated by the variables of $R$</span>              </li>
            </ul>
          </li>
          <li>
<a href="../../Macaulay2Doc/html/_using_spfunctions_spwith_spoptional_spinputs.html">Optional inputs</a>:            <ul>
              <li>
<span><tt>ContainmentTest</tt><tt> => </tt><span>a <a title="the class of all symbols" href="../../Macaulay2Doc/html/___Symbol.html">symbol</a></span>, <span>default value null</span>, specifies the manner in which to verify the containment of powers of <tt>I</tt> or <tt>f</tt> in <tt>J^{[p^e]}</tt></span>              </li>
              <li>
<span><tt>AtOrigin</tt><tt> => </tt><span>a <a title="the class of Boolean values" href="../../Macaulay2Doc/html/___Boolean.html">Boolean value</a></span>, <span>default value true</span>, if <tt>false</tt>, tells the function to take the minimum value over all possible maximal ideals J</span>              </li>
              <li>
<span><tt>ReturnList</tt><tt> => </tt><span>a <a title="the class of Boolean values" href="../../Macaulay2Doc/html/___Boolean.html">Boolean value</a></span>, <span>default value false</span>, specifies whether to return the list <tt>\{\nu(1),\ldots,\nu(p^e)\}</tt>, as opposed to just <tt>\nu(p^e)</tt></span>              </li>
              <li>
<span><tt>Search</tt><tt> => </tt><span>a <a title="the class of all symbols" href="../../Macaulay2Doc/html/___Symbol.html">symbol</a></span>, <span>default value Binary</span>, specifies the strategy to be used in the search for the largest power of <tt>I</tt> or <tt>f</tt> not contained in <tt>J^{[p^e]}</tt></span>              </li>
              <li>
<span><tt>UseSpecialAlgorithms</tt><tt> => </tt><span>a <a title="the class of Boolean values" href="../../Macaulay2Doc/html/___Boolean.html">Boolean value</a></span>, <span>default value true</span>, specifies whether to use special algorithms to compute the $F$-pure threshold of <tt>f</tt>, for certain special types of polynomials</span>              </li>
              <li>
<span><tt>Verbose</tt><tt> => </tt><span>a <a title="the class of Boolean values" href="../../Macaulay2Doc/html/___Boolean.html">Boolean value</a></span>, <span>default value false</span>, requests verbose feedback, where <tt>\nu(1)</tt>, <tt>\nu(p)</tt>, <tt>\nu(p^2)</tt>, etc., are printed as they are computed</span>              </li>
            </ul>
          </li>
          <li>
Outputs:            <ul>
              <li>
<span><span>an <a title="the class of all integers" href="../../Macaulay2Doc/html/___Z__Z.html">integer</a></span>, the largest integer <tt>\nu\ = \nu(p^e)</tt> such that <tt>I^{\nu}</tt> (or <tt>f^{\nu}</tt>, or <tt>I^{[\nu]}</tt>, depending on the arguments and options passed) is not contained in <tt>J^{[p^e]}</tt></span>              </li>
              <li>
<span><span>an <a title="the class of all infinite numbers" href="../../Macaulay2Doc/html/___Infinite__Number.html">infinite number</a></span>, if <tt>I</tt> or <tt>f</tt> is not contained in the radical of $J$, or when <tt>AtOrigin => false</tt>, if <tt>I</tt> or <tt>f</tt> is a unit ideal</span>              </li>
              <li>
<span><span>a <a title="the class of all lists -- {...}" href="../../Macaulay2Doc/html/___List.html">list</a></span>, containing <tt>\nu(p^i)</tt>, for <tt>i = 0,\ldots,e</tt></span>              </li>
            </ul>
          </li>
        </ul>
      </div>
      <div>
        <h2>Description</h2>
        <div>
          <p>Consider an element $f$ of a polynomial ring $R$ over a finite field of characteristic $p$, and an ideal $J$ of this ring. If $f$ is contained in the radical of $J$, then the command <tt>frobeniusNu(e,f,J)</tt> outputs the maximal exponent $n$ such that $f^{ n}$ is not contained in the $p^e$-th Frobenius power of $J$. More generally, if $I$ is an ideal contained in the radical of $J$, then <tt>frobeniusNu(e,I,J)</tt> outputs the maximal integer exponent $n$ such that $I^n$ is not contained in the $p^e$-th Frobenius power of $J$.</p>
          <p>These numbers are denoted $\nu_f^J(p^e)$ and $\nu_I^J(p^e)$, respectively, in the literature, and were originally defined in the paper <i>$F$-thresholds and Bernstein-Sato Polynomials</i>, by Mustaţă, Takagi, and Watanabe.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i1 : R = ZZ/11[x,y];</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i2 : I = ideal(x^2 + y^3, x*y);

o2 : Ideal of R</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i3 : J = ideal(x^2, y^3);

o3 : Ideal of R</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i4 : frobeniusNu(1, I, J)

o4 = 24</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i5 : f = x*y*(x^2 + y^2);</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i6 : frobeniusNu(3, f, J)

o6 = 1330</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>If $f$ or $I$ is zero, then <tt>frobeniusNu</tt> returns <tt>0</tt>; if $f$ or $I$ is not contained in the radical of $J$, <tt>frobeniusNu</tt> returns infinity.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i7 : frobeniusNu(1, 0_R, J)

o7 = 0</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i8 : frobeniusNu(1, 1_R, J)

o8 = infinity

o8 : InfiniteNumber</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>When the third argument is omitted, the ideal $J$ is assumed to be the homogeneous maximal ideal of $R$.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i9 : R = ZZ/17[x,y,z];</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i10 : f = x^3 + y^4 + z^5;</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i11 : frobeniusNu(2, f)

o11 = 220</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i12 : frobeniusNu(2, f, ideal(x, y, z))

o12 = 220</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>It is well known that if $q=p^e$ for some nonnegative integer $e$, then $\nu_I^J(qp) = \nu_I^J(q) p + L$, where the error term $L$ is nonnegative, and can be explicitly bounded from above in terms of $p$ and the number of generators of $I$ and $J$ (e.g., $L$ is at most $p-1$ when $I$ is principal). This implies that when searching for <tt>frobeniusNu(e,I,J)</tt>, it is always safe to start at $p$ times <tt>frobeniusNu(e-1,I,J)</tt>, and one need not search too far past this number, and suggests that the most efficient way to compute <tt>frobeniusNu(e,I,J)</tt> is to compute, successively, <tt>frobeniusNu(i,I,J)</tt>, for <tt>i = 0,\ldots,e</tt>. This is indeed how the computation is done in most cases.</p>
          <p>If $M$ is the homogeneous maximal ideal of $R$ and $f$ is an element of $R$, the numbers $\nu_f^M(p^e)$ determine and are determined by the $F$-pure threshold of $f$ at the origin. Indeed, $\nu_f^M(p^e)$ is $p^e$ times the truncation of the non-terminating base $p$ expansion of fpt($f$) at its $e$^{th} spot. This fact is used to speed up the computations for certain polynomials whose $F$-pure thresholds can be quickly computed via special algorithms, namely diagonal polynomials, binomials, forms in two variables, and polynomials whose factors are in simple normal crossing. This feature can be disabled by setting the option <tt>UseSpecialAlgorithms</tt> (default value <tt>true</tt>) to <tt>false</tt>.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i13 : R = ZZ/17[x,y,z];</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i14 : f = x^3 + y^4 + z^5; -- a diagonal polynomial</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i15 : time frobeniusNu(3, f)
     -- used 0.00636186 seconds

o15 = 3756</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i16 : time frobeniusNu(3, f, UseSpecialAlgorithms => false)
     -- used 0.31488 seconds

o16 = 3756</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>The valid values for the option <tt>ContainmentTest</tt> are <tt>FrobeniusPower</tt>, <tt>FrobeniusRoot</tt>, and <tt>StandardPower</tt>. The default value of this option depends on what is passed to <tt>frobeniusNu</tt>. Indeed, by default, <tt>ContainmentTest</tt> is set to <tt>FrobeniusRoot</tt> if <tt>frobeniusNu</tt> is passed a ring element $f$, and is set to <tt>StandardPower</tt> if <tt>frobeniusNu</tt> is passed an ideal $I$. We describe the consequences of setting <tt>ContainmentTest</tt> to each of these values below.</p>
          <p>First, if <tt>ContainmentTest</tt> is set to <tt>StandardPower</tt>, then the ideal containments checked when computing <tt>frobeniusNu(e,I,J)</tt> are verified directly. That is, the standard power $I^n$ is first computed, and a check is then run to see if it is contained in the $p^e$-th Frobenius power of $J$.</p>
          <p>Alternately, if <tt>ContainmentTest</tt> is set to <tt>FrobeniusRoot</tt>, then the ideal containments are verified using Frobenius Roots. That is, the $p^e$-th Frobenius root of $I^n$ is first computed, and a check is then run to see if it is contained in $J$. The output is unaffected, but this option often speeds up computations, specially when a polynomial or principal ideal is passed as the second argument.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i17 : R = ZZ/5[x,y,z];</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i18 : f = x^3 + y^3 + z^3 + x*y*z;</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i19 : time frobeniusNu(4, f) -- ContainmentTest is set to FrobeniusRoot, by default
     -- used 0.322889 seconds

o19 = 499</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i20 : time frobeniusNu(4, f, ContainmentTest => StandardPower)
     -- used 2.26048 seconds

o20 = 499</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>Finally, when <tt>ContainmentTest</tt> is set to <tt>FrobeniusPower</tt>, then instead of producing the invariant $\nu_I^J(p^e)$ as defined above, <tt>frobeniusNu</tt> instead outputs the maximal integer $n$ such that the $n$^{th} (generalized) Frobenius power of $I$ is not contained in the $p^e$-th Frobenius power of $J$. Here, the $n$^{th} Frobenius power of $I$, when $n$ is a nonnegative integer, is as defined in the paper <i>Frobenius Powers</i> by Hernández, Teixeira, and Witt, which can be computed with the function <a title="compute a (generalized) Frobenius power of an ideal" href="../../TestIdeals/html/_frobenius__Power.html">frobeniusPower</a>, from the <a title="a package for calculations of singularities in positive characteristic " href="../../TestIdeals/html/index.html">TestIdeals</a> package. In particular, <tt>frobeniusNu(e,I,J)</tt> and <tt>frobeniusNu(e,I,J,ContainmentTest=>FrobeniusPower)</tt> need not agree. However, they will agree when $I$ is a principal ideal.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i21 : R = ZZ/3[x,y];</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i22 : M = ideal(x, y);

o22 : Ideal of R</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i23 : frobeniusNu(3, M^5)

o23 = 10</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i24 : frobeniusNu(3, M^5, ContainmentTest => FrobeniusPower)

o24 = 8</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>The function <tt>frobeniusNu</tt> works by searching through the list of potential integers $n$ and checking containments of $I^n$ in the specified Frobenius power of $J$. The way this search is approached is specified by the option <tt>Search</tt>, which can be set to <tt>Binary</tt> (the default value) or <tt>Linear</tt>.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i25 : R = ZZ/5[x,y,z];</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i26 : f = x^2*y^4 + y^2*z^7 + z^2*x^8;</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i27 : time frobeniusNu(5, f) -- uses binary search (default)
     -- used 0.644837 seconds

o27 = 1124</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i28 : time frobeniusNu(5, f, Search => Linear)
     -- used 1.21811 seconds

o28 = 1124</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i29 : M = ideal(x, y, z);

o29 : Ideal of R</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i30 : time frobeniusNu(2, M, M^2) -- uses binary search (default)
     -- used 2.51481 seconds

o30 = 97</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i31 : time frobeniusNu(2, M, M^2, Search => Linear) -- but linear search gets luckier
     -- used 0.903972 seconds

o31 = 97</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>The option <tt>AtOrigin</tt> (default value <tt>true</tt>) can be turned off to tell <tt>frobeniusNu</tt> to effectively do the computation over all possible maximal ideals $J$ and take the minimum.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i32 : R = ZZ/7[x,y];</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i33 : f = (x - 1)^3 - (y - 2)^2;</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i34 : frobeniusNu(1, f)

o34 = infinity

o34 : InfiniteNumber</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i35 : frobeniusNu(1, f, AtOrigin => false)

o35 = 5</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>The option <tt>ReturnList</tt> (default value <tt>false</tt>) can be used to request that the output be not only $\nu_I^J(p^e)$, but a list containing $\nu_I^J(p^i)$, for $i=0,\ldots,e$.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i36 : R = ZZ/5[x,y,z];</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i37 : f = x^2*y^4 + y^2*z^7 + z^2*x^8;</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i38 : frobeniusNu(5, f, ReturnList => true)

o38 = {0, 1, 8, 44, 224, 1124}

o38 : List</code></pre>
</td>          </tr>
        </table>
        <div>
          <p>Alternatively, the option <tt>Verbose</tt> (default value <tt>false</tt>) can be used to request that the values $\nu_I^J(p^i)$ ($i=0,\ldots,e$) be printed as they are computed, to monitor the progress of the computation.</p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i39 : frobeniusNu(5, f, Verbose => true)
nuInternal: using comparison test FrobeniusRoot
ν(1) = 0
ν(p^1) = 1
ν(p^2) = 8
ν(p^3) = 44
ν(p^4) = 224
ν(p^5) = 1124

o39 = 1124</code></pre>
</td>          </tr>
        </table>
      </div>
      <div>
        <h2>See also</h2>
        <ul>
          <li>
<span><a title="attempt to compute the F-pure threshold of a polynomial at the origin or globally" href="_fpt.html">fpt</a> -- attempt to compute the F-pure threshold of a polynomial at the origin or globally</span>          </li>
        </ul>
      </div>
      <div class="waystouse">
        <h2>Ways to use <tt>frobeniusNu</tt> :</h2>
        <ul>
          <li>
<tt>&quot;frobeniusNu(ZZ,Ideal)&quot;</tt>          </li>
          <li>
<tt>&quot;frobeniusNu(ZZ,Ideal,Ideal)&quot;</tt>          </li>
          <li>
<tt>&quot;frobeniusNu(ZZ,RingElement)&quot;</tt>          </li>
          <li>
<tt>&quot;frobeniusNu(ZZ,RingElement,Ideal)&quot;</tt>          </li>
        </ul>
      </div>
      <div class="waystouse">
        <h2>For the programmer</h2>
        <p>The object <a title="computes the largest power of an ideal not contained in a specified Frobenius power" href="_frobenius__Nu.html">frobeniusNu</a> is <span>a <a title="a type of method function" href="../../Macaulay2Doc/html/___Method__Function__With__Options.html">method function with options</a></span>.</p>
      </div>
    </div>
  </body>

</html>
