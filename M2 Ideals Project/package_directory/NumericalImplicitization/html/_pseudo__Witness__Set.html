<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0 plus SVG 1.1//EN" "http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>pseudoWitnessSet -- computes a pseudo-witness set for the image of a variety</title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <link type="text/css" rel="stylesheet" href="../../../../Macaulay2/Style/doc.css"/>

    <link rel="stylesheet" href="../../../../Macaulay2/Style/katex/katex.min.css" />
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/katex.min.js"></script>
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/auto-render.min.js"></script>
    <script defer="defer" type="text/javascript">
      var macros = {
          "\\break": "\\\\",
          "\\ZZ": "\\mathbb{Z}",
          "\\NN": "\\mathbb{N}",
          "\\QQ": "\\mathbb{Q}",
          "\\RR": "\\mathbb{R}",
          "\\CC": "\\mathbb{C}",
          "\\PP": "\\mathbb{P}"
      }, delimiters = [
          { left: "$$",  right: "$$",  display: true},
          { left: "\\[", right: "\\]", display: true},
          { left: "$",   right: "$",   display: false},
          { left: "\\(", right: "\\)", display: false}
      ], ignoredTags = ["tt", "script", "noscript", "style", "textarea", "pre", "code", "option"];
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, { delimiters: delimiters, macros: macros, ignoredTags: ignoredTags, trust: true });
      });
    </script>
    <style type="text/css">.katex { font-size: 1em; }</style>
    <link href="../../../../Macaulay2/Style/katex/contrib/copy-tex.min.css" rel="stylesheet" type="text/css" />
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/copy-tex.min.js"></script>
    <script defer="defer" type="text/javascript" src="../../../../Macaulay2/Style/katex/contrib/render-a11y-string.min.js"></script>
    <script type="text/javascript" src="../../../../Macaulay2/Style/highlight.js"></script>
  </head>
  <body>
    <table class="buttons">
      <tr>
<td>          <div>
<a href="_pseudo__Witness__Set_lp..._cm__Software_eq_gt..._rp.html">next</a> | <a href="___Pseudo__Witness__Set.html">previous</a> | <a href="_pseudo__Witness__Set_lp..._cm__Software_eq_gt..._rp.html">forward</a> | <a href="___Pseudo__Witness__Set.html">backward</a> | up | <a href="index.html">top</a> | <a href="master.html">index</a> | <a href="toc.html">toc</a> | <a href="http://macaulay2.com/">Macaulay2 website</a>          </div>
</td>      </tr>
    </table>
    <div>
<a title="implicitization using numerical algebraic geometry" href="index.html">NumericalImplicitization</a> :: <a title="computes a pseudo-witness set for the image of a variety" href="_pseudo__Witness__Set.html">pseudoWitnessSet</a>    </div>
    <hr/>
    <div>
      <h1>pseudoWitnessSet -- computes a pseudo-witness set for the image of a variety</h1>
      <div>
        <h2>Synopsis</h2>
        <ul>
          <li>
            <dl class="element">
              <dt>Usage: </dt>
              <dd><code class="language-macaulay2">pseudoWitnessSet(F, I)</code></dd>
              <dd><code class="language-macaulay2">pseudoWitnessSet(F, I, p)</code></dd>
              <dd><code class="language-macaulay2">pseudoWitnessSet(F, I, P, L)</code></dd>
            </dl>
          </li>
          <li>
Inputs:            <ul>
              <li>
<span><tt>F</tt>, a <a title="the class of all matrices" href="../../Macaulay2Doc/html/___Matrix.html">matrix</a>, or <a title="the class of all lists -- {...}" href="../../Macaulay2Doc/html/___List.html">list</a>, or <a title="the class of all ring maps" href="../../Macaulay2Doc/html/___Ring__Map.html">ring map</a>, specifying a map</span>              </li>
              <li>
<span><tt>I</tt>, <span>an <a title="the class of all ideals" href="../../Macaulay2Doc/html/___Ideal.html">ideal</a></span>, which is prime, specifying a source variety $V(I)$</span>              </li>
              <li>
<span><tt>p</tt>, <span>an instance of the type <a title="a type used to store a point in complex space" href="../../NAGtypes/html/___Abstract__Point.html">Point</a></span>, a general point on the source $V(I)$</span>              </li>
              <li>
<span><tt>P</tt>, <span>a <a title="the class of all lists -- {...}" href="../../Macaulay2Doc/html/___List.html">list</a></span>, of pairs $(p, q)$ with $p$ a general point on the source $V(I)$, and $q = F(p)$. In this case an input slice $L$ must also be provided, and $q$ should additionally lie on $L$.</span>              </li>
              <li>
<span><tt>L</tt>, <span>a <a title="the class of all matrices" href="../../Macaulay2Doc/html/___Matrix.html">matrix</a></span>, representing a linear slice of $F(V(I))$. The format should be a row matrix, whose entries are linear forms in the ambient target space of $F(V(I))$. If this is provided then a nonempty list $P$ of point pairs must also be provided.</span>              </li>
            </ul>
          </li>
          <li>
<a href="../../Macaulay2Doc/html/_using_spfunctions_spwith_spoptional_spinputs.html">Optional inputs</a>:            <ul>
              <li>
<span><tt>DoRefinements</tt><tt> => </tt><tt>...</tt>, <span>default value false</span></span>              </li>
              <li>
<span><tt>DoTraceTest</tt><tt> => </tt><tt>...</tt>, <span>default value true</span></span>              </li>
              <li>
<span><tt>MaxAttempts</tt><tt> => </tt><tt>...</tt>, <span>default value 5</span></span>              </li>
              <li>
<span><tt>MaxPoints</tt><tt> => </tt><tt>...</tt>, <span>default value infinity</span></span>              </li>
              <li>
<span><a title="specifies the maximum number of processor threads" href="___Max__Threads.html">MaxThreads</a><tt> => </tt><tt>...</tt>, <span>default value 1</span>, specifies the maximum number of processor threads</span>              </li>
              <li>
<span><tt>Repeats</tt><tt> => </tt><tt>...</tt>, <span>default value 3</span></span>              </li>
              <li>
<span><a title="specify software for homotopy continuation" href="_pseudo__Witness__Set_lp..._cm__Software_eq_gt..._rp.html">Software</a><tt> => </tt><tt>...</tt>, <span>default value M2engine</span>, specify software for homotopy continuation</span>              </li>
              <li>
<span><tt>Threshold</tt><tt> => </tt><tt>...</tt>, <span>default value 5</span></span>              </li>
              <li>
<span><tt>TraceThreshold</tt><tt> => </tt><tt>...</tt>, <span>default value .00001</span></span>              </li>
              <li>
<span><a title="display detailed output" href="_numerical__Image__Degree_lp..._cm__Verbose_eq_gt..._rp.html">Verbose</a><tt> => </tt><tt>...</tt>, <span>default value true</span>, display detailed output</span>              </li>
            </ul>
          </li>
          <li>
Outputs:            <ul>
              <li>
<span><span>a <a title="the class of all pseudo-witness sets" href="___Pseudo__Witness__Set.html">pseudo-witness set</a></span>, a pseudo-witness set for $F(V(I))$</span>              </li>
            </ul>
          </li>
        </ul>
      </div>
      <div>
        <h2>Description</h2>
        <div>
          <p>This method computes a <a title="the class of all pseudo-witness sets" href="___Pseudo__Witness__Set.html">pseudo-witness set</a> for the image of a variety, by computing the intersection of the image with a complementary-dimensional linear slice via tracking monodromy loops with homotopy continuation, and then applying the trace test. If the trace test fails, only a lower bound for the degree and an incomplete pseudo-witness set is returned. This technique circumvents the calculation of the kernel of the associated ring map.</p>
          <p>The method also allows the user to provide a particular linear slice $L$ of the image. In this case a list of point pairs $(p, q)$ such that $p$ is in $V(I)$, $q = F(p)$, and $q$ is in $L$, must be provided (to have an initial input point to the monodromy - even if it only consists of a single such pair). The method then applies monodromy to try to compute the entire intersection $F(V(I))\cap L$. If no linear slice is given, then a random complementary-dimensional linear slice will be chosen, in which case no seed is needed, as an initial point pair will be chosen to lie on the slice.</p>
          <p>The following example computes the degree of the Grassmannian $Gr(2,4)$ of $P^1$'s in $P^3$, under its Pl&amp;uuml;cker embedding in $P^5$.</p>
          <p></p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i1 : R = CC[x_(1,1)..x_(2,4)];</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i2 : F = (minors(2, genericMatrix(R, 2, 4)))_*;</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i3 : W = pseudoWitnessSet(F, ideal 0_R)
Sampling point in source ...
Tracking monodromy loops ...
Points found: 2
Points found: 2
Points found: 2
Points found: 2
Running trace test ...

o3 = a &quot;pseudo-witness set&quot;, indicating
     the image has degree 2

o3 : PseudoWitnessSet</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i4 : W.isCompletePseudoWitnessSet

o4 = true</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i5 : W.degree

o5 = 2</code></pre>
</td>          </tr>
        </table>
        <div>
          <p></p>
          <p>This method can also handle cases where the parameterization has positive dimensional fibers. In the example below, we verify that the variety of $3 x 3 x 3$ tensors of border rank $&lt;= 4$, i.e. the $4$th secant variety of $P^2 x P^2 x P^2$, has degree $9$. This is a hypersurface, with defining equation known as Strassen's invariant, and it is also a defective secant variety (meaning its dimension is less than expected). Here, the parametrization has $10$ dimensional fibers. For more on this example, see V. Strassen, $The asymptotic spectrum of tensors$, J. Reine Angew. Math. 384 (1988), 102-152.</p>
          <p></p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i6 : R = CC[a_(0,0)..a_(3,2), b_(0,0)..b_(3,2), c_(0,0)..c_(3,2)];</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i7 : F = toList apply((0,0,0)..(2,2,2), (i,j,k) ->
        a_(0,i)*b_(0,j)*c_(0,k) +
        a_(1,i)*b_(1,j)*c_(1,k) +
        a_(2,i)*b_(2,j)*c_(2,k) +
        a_(3,i)*b_(3,j)*c_(3,k));</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i8 : pseudoWitnessSet(F, ideal 0_R, Repeats => 2)
Sampling point in source ...
Tracking monodromy loops ...
Points found: 1
Points found: 2
Points found: 3
Points found: 5
Points found: 7
Points found: 9
Points found: 9
Points found: 9
Running trace test ...

o8 = a pseudo-witness set, indicating
    the degree of the image is 9

o8 : PseudoWitnessSet</code></pre>
</td>          </tr>
        </table>
        <div>
          <p></p>
          <p>Finally, this method has a large number of optional inputs which may be specified by the user to fit a particular problem instance.</p>
          <p>The option <tt>Repeats</tt> sets the maximum number of consecutive repetitive monodromy loops when computing a pseudo-witness set. A repetitive monodromy loop is one where no new points in the image are discovered. After this many consecutive repetitive monodromy loops occur, the trace test is applied to determine if a complete pseudo-witness set has been found. The default value is $3$.</p>
          <p>The option <tt>MaxAttempts</tt> sets the maximum number of times the trace test will be attempted when computing a pseudo-witness set. After a trace test fails, a new slice is chosen, the previous points are tracked to the new slice, and monodromy is performed anew. If the trace test has failed <tt>MaxAttempts</tt> many times, an incomplete pseudo-witness set is returned. The default value is $5$.</p>
          <p>Here is an example in which a badly chosen random seed results in a failed trace test on the first attempt.  In later attempts, the trace test passes and the degree of the twisted cubic is correctly computed to be $3$.</p>
          <p></p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i6 : setRandomSeed 10

o6 = 10</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i7 : R = CC[s,t]

o7 = R

o7 : PolynomialRing</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i8 : F = basis(3, R)
-- warning: experimental computation over inexact field begun
--          results not reliable (one warning given per session)

o8 = | s3 s2t st2 t3 |

             1       4
o8 : Matrix R  &lt;--- R</code></pre>
</td>          </tr>
          <tr>
<td>              <pre><code class="language-macaulay2">i9 : pseudoWitnessSet(F, ideal 0_R)
Sampling point in source ...
Tracking monodromy loops ...
Points found: 2
Points found: 2
Points found: 2
Points found: 2
Running trace test ...
Failed trace test! Trace: .0128189
Tracking monodromy loops ...
Points found: 2
Points found: 3
Points found: 3
Points found: 3
Points found: 3
Running trace test ...

o9 = a &quot;pseudo-witness set&quot;, indicating
     the image has degree 3

o9 : PseudoWitnessSet</code></pre>
</td>          </tr>
        </table>
        <div>
          <p></p>
          <p>We compare this with the native $Macaulay2$ function <a href="../../Macaulay2Doc/html/_degree_lp__Ideal_rp.html">degree</a> (using a symbolic Gr&amp;ouml;bner basis computation).</p>
          <p></p>
        </div>
        <table class="examples">
          <tr>
<td>              <pre><code class="language-macaulay2">i10 : degree ker map(QQ[s,t], QQ[y_0..y_3], {s^3,s^2*t,s*t^2,t^3})

o10 = 3</code></pre>
</td>          </tr>
        </table>
        <div>
          <p></p>
          <p>The option <tt>MaxPoints</tt> sets a number of points such that if more than this number of points is found following a monodromy loop, then the method gracefully exits. The option is especially useful in the case that the user specifies a linear slice $L$ (as discussed above) which is in special position with respect to $F(V(I))$ (e.g. if $F(V(I))\cap L$ is positive-dimensional). The default value is <a title="infinity" href="../../Macaulay2Doc/html/_infinity.html">infinity</a>.</p>
          <p>The option <tt>DoRefinements</tt> specifies whether or not to refine solution points found via monodromy. Refinement of points may improve their accuracy. If the value of this option is true, then refinement occurs after every tracking (which may increase the time for computation). The default value is <a href="../../Macaulay2Doc/html/_false.html">false</a>.</p>
          <p>The option <tt>DoTraceTest</tt> specifies whether or not to run the trace test. This is useful when the user specifies a special linear slice $L$ (as in the discussion on <tt>MaxPoints</tt> above). The default value is <a href="../../Macaulay2Doc/html/_true.html">true</a>.</p>
          <p>The option <tt>TraceThreshold</tt> sets the threshold for a pseudo-witness set to pass the trace test. The trace for a complete exact pseudo-witness set is $0$; large nonzero values indicate failure (the larger the value, the worse the failure). The default value is $1e-5$.</p>
          <p>The option <tt>Threshold</tt> sets the threshold for determining point equality. If this option has value $n$, then two points are considered equal iff their first $n$ significant digits agree (equivalently, in scientific notation, the exponents and first $n$ digits of the mantissa agree). The default value is $5$.</p>
        </div>
      </div>
      <div>
        <h2>See also</h2>
        <ul>
          <li>
<span><a title="the class of all pseudo-witness sets" href="___Pseudo__Witness__Set.html">PseudoWitnessSet</a> -- the class of all pseudo-witness sets</span>          </li>
          <li>
<span><a title="computes the degree of the image of a variety" href="_numerical__Image__Degree.html">numericalImageDegree</a> -- computes the degree of the image of a variety</span>          </li>
        </ul>
      </div>
      <div class="waystouse">
        <h2>Ways to use <tt>pseudoWitnessSet</tt> :</h2>
        <ul>
          <li>
<tt>&quot;pseudoWitnessSet(List,Ideal)&quot;</tt>          </li>
          <li>
<tt>&quot;pseudoWitnessSet(List,Ideal,List,Thing)&quot;</tt>          </li>
          <li>
<tt>&quot;pseudoWitnessSet(List,Ideal,Point)&quot;</tt>          </li>
          <li>
<tt>&quot;pseudoWitnessSet(Matrix,Ideal)&quot;</tt>          </li>
          <li>
<tt>&quot;pseudoWitnessSet(Matrix,Ideal,List,Thing)&quot;</tt>          </li>
          <li>
<tt>&quot;pseudoWitnessSet(Matrix,Ideal,Point)&quot;</tt>          </li>
          <li>
<tt>&quot;pseudoWitnessSet(RingMap,Ideal)&quot;</tt>          </li>
          <li>
<tt>&quot;pseudoWitnessSet(RingMap,Ideal,List,Thing)&quot;</tt>          </li>
          <li>
<tt>&quot;pseudoWitnessSet(RingMap,Ideal,Point)&quot;</tt>          </li>
        </ul>
      </div>
      <div class="waystouse">
        <h2>For the programmer</h2>
        <p>The object <a title="computes a pseudo-witness set for the image of a variety" href="_pseudo__Witness__Set.html">pseudoWitnessSet</a> is <span>a <a title="a type of method function" href="../../Macaulay2Doc/html/___Method__Function__With__Options.html">method function with options</a></span>.</p>
      </div>
    </div>
  </body>

</html>
